"use strict";var Prime=Prime||{};Prime.Ajax=Prime.Ajax||{};Prime.Ajax.Request=function(url,method){Prime.Utils.bindAll(this);this.xhr=new XMLHttpRequest;this.async=true;this.body=null;this.queryParams=null;this.contentType=null;this.errorHandler=this.onError;this.headers={};this.loadingHandler=this.onLoading;this.method=method||"GET";this.openHandler=this.onOpen;this.password=null;this.sendHandler=this.onSend;this.successHandler=this.onSuccess;this.unsetHandler=this.onUnset;this.url=url;this.username=null};Prime.Ajax.Request.prototype={forURL:function(url){this.url=url;return this},go:function(){if(!this.url){throw new TypeError("No URL set for AJAX request")}var requestUrl=this.url;if((this.method==="GET"||this.method==="DELETE")&&this.queryParams!==null){if(requestUrl.indexOf("?")===-1){requestUrl+="?"+this.queryParams}else{requestUrl+="&"+this.queryParams}}if(this.async){this.xhr.onreadystatechange=this._handler.bind(this)}this.xhr.open(this.method,requestUrl,this.async,this.username,this.password);if(Object.keys(this.headers).length>0){for(var key in this.headers){if(this.headers.hasOwnProperty(key)){this.xhr.setRequestHeader(key,this.headers[key])}}}if(this.contentType){this.xhr.setRequestHeader("Content-Type",this.contentType)}this.xhr.send(this.body);return this},onError:function(xhr){},onLoading:function(xhr){},onOpen:function(xhr){},onSend:function(xhr){},onSuccess:function(xhr){},onUnset:function(xhr){},synchronously:function(){this.async=false;return this},usingMethod:function(method){this.method=method;return this},withBody:function(body){this.body=body;return this},withContentType:function(contentType){this.contentType=contentType;return this},withData:function(data){for(var prop in data){if(data.hasOwnProperty(prop)){if(this.method==="PUT"||this.method==="POST"){this.body=this._addDataValue(this.body,prop,data[prop])}else{this.queryParams=this._addDataValue(this.queryParams,prop,data[prop])}}}if(this.method==="PUT"||this.method==="POST"){this.contentType="application/x-www-form-urlencoded"}return this},withDataFromForm:function(form){var domElement=form;if(form instanceof Prime.Document.Element){domElement=form.domElement}for(var i=0;i<domElement.elements.length;i++){var primeElement=new Prime.Document.Element(domElement.elements[i]);if(primeElement.isDisabled()||!primeElement.isInput()){continue}var type=primeElement.getAttribute("type");if(type!==null){type=type.toLowerCase()}var values;if(primeElement.getTagName()==="SELECT"){values=primeElement.getSelectedValues()}else if((type==="radio"||type==="checkbox")&&!primeElement.isChecked()){continue}else{values=primeElement.getValue()}var name=primeElement.domElement.name;if(this.method==="PUT"||this.method==="POST"){this.body=this._addDataValue(this.body,name,values)}else{this.queryParams=this._addDataValue(this.queryParams,name,values)}}if(this.method==="PUT"||this.method==="POST"){this.contentType="application/x-www-form-urlencoded"}return this},withErrorHandler:function(func){this.errorHandler=func;return this},withJSON:function(json){this.body=typeof json===String?json:JSON.stringify(json);this.contentType="application/json";return this},withLoadingHandler:function(func){this.loadingHandler=func;return this},withHeader:function(key,value){this.headers[key]=value;return this},withHeaders:function(headers){for(var key in headers){if(headers.hasOwnProperty(key)){this.headers[key]=headers[key]}}return this},withResponseType:function(responseType){this.xhr.responseType=responseType;return this},withOpenHandler:function(func){this.openHandler=func;return this},withSendHandler:function(func){this.sendHandler=func;return this},withSuccessHandler:function(func){this.successHandler=func;return this},withUnsetHandler:function(func){this.unsetHandler=func;return this},reset:function(){this.queryParams=null;this.data=null;this.body=null;this.contentType=null;return this},_handler:function(){if(this.xhr.readyState===0){this.unsetHandler(this.xhr)}else if(this.xhr.readyState===1){this.openHandler(this.xhr)}else if(this.xhr.readyState===2){this.sendHandler(this.xhr)}else if(this.xhr.readyState===3){this.loadingHandler(this.xhr)}else if(this.xhr.readyState===4){if(this.xhr.status>=200&&this.xhr.status<=299){this.successHandler(this.xhr)}else{this.errorHandler(this.xhr)}}},_addDataValue:function(dataString,name,value){var result="";if(value instanceof Array){for(var i=0;i<value.length;i++){result+=encodeURIComponent(name)+"="+encodeURIComponent(value[i]);if(i+1<value.length){result+="&"}}}else{result=encodeURIComponent(name)+"="+encodeURIComponent(value)}if(dataString!==null&&result!==""){result=dataString+"&"+result}else if(dataString!==null&&result===""){result=dataString}return result}};"use strict";var Prime=Prime||{};Prime.Browser={detect:function(){this.name=this._searchString(this.dataBrowser)||"An unknown browser";this.version=this._searchVersion(navigator.userAgent)||this._searchVersion(navigator.appVersion)||"an unknown version";this.os=this._searchString(this.dataOS)||"an unknown OS"},_searchString:function(data){for(var i=0;i<data.length;i++){var dataString=data[i].string;var dataProp=data[i].prop;this.versionSearchString=data[i].versionSearch||data[i].identity;if(dataString&&dataString.indexOf(data[i].subString)!==-1){return data[i].identity}else if(dataProp){return data[i].identity}}return null},_searchVersion:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(index===-1){return null}return parseFloat(dataString.substring(index+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};Prime.Browser.detect();"use strict";var Prime=Prime||{};Prime.Data=Prime.Data||{};Prime.Data.Queue=function(){Prime.Utils.bindAll(this);this._elements={};this._head=0;this._tail=0};Prime.Data.Queue.constructor=Prime.Data.Queue;Prime.Data.Queue.prototype={add:function(element){this._elements[this._head]=element;this._head++;return this},isEmpty:function(){return this._head===this._tail},peek:function(){if(this.isEmpty()){return null}return this._elements[this._tail]},poll:function(){if(this.isEmpty()){return null}var object=this._elements[this._tail];delete this._elements[this._tail];this._tail++;if(this._cursor<this._tail){this._cursor=this._tail}return object},size:function(){return this._head-this._tail}};"use strict";var Prime=Prime||{};Prime.Date={DAYS_IN_MONTH:[31,28,31,30,31,30,31,31,30,31,30,31],getHourOfDay:function(date){return(date.getHours()+24)%12||12},isLeapYear:function(year){return!(year%4||!(year%100)&&year%400)},numberOfDaysInMonth:function(year,month){if(month===1&&this.isLeapYear(year)){return 29}else{return Prime.Date.DAYS_IN_MONTH[month]}},plusDays:function(date,number){if(number===0){return}var newDate=date.getDate()+number;var numberOfDaysInMonth=Prime.Date.numberOfDaysInMonth(date.getFullYear(),date.getMonth());if(newDate>0){while(newDate>numberOfDaysInMonth){Prime.Date.plusMonths(date,1);newDate=newDate-numberOfDaysInMonth;numberOfDaysInMonth=Prime.Date.numberOfDaysInMonth(date.getFullYear(),date.getMonth())}date.setDate(newDate)}else{while(newDate<=0){Prime.Date.plusMonths(date,-1);numberOfDaysInMonth=Prime.Date.numberOfDaysInMonth(date.getFullYear(),date.getMonth());newDate=newDate+numberOfDaysInMonth}date.setDate(newDate)}},plusHours:function(date,number){if(number===0){return}var deltaDays=parseInt(number/24);Prime.Date.plusDays(date,deltaDays);var deltaHours=number%24;var newHour=date.getHours()+deltaHours;if(newHour>23){Prime.Date.plusDays(date,1);date.setHours(newHour-24)}else if(newHour<0){Prime.Date.plusDays(date,-1);date.setHours(24+newHour)}else{date.setHours(newHour)}},plusMinutes:function(date,number){if(number===0){return}var deltaHours=parseInt(number/60);Prime.Date.plusHours(date,deltaHours);var deltaMinutes=number%60;var newMinute=date.getMinutes()+deltaMinutes;if(newMinute>60){Prime.Date.plusHours(date,1);date.setMinutes(newMinute-60)}else if(newMinute<0){Prime.Date.plusHours(date,-1);date.setMinutes(60+newMinute)}else{date.setMinutes(newMinute)}},plusMonths:function(date,number){if(number===0){return}var deltaYears=parseInt(number/12);var deltaMonths=number%12;var currentMonth=date.getMonth();var newMonth=currentMonth+deltaMonths;if(newMonth<0){deltaYears--;deltaMonths=newMonth;currentMonth=12}else if(newMonth>=12){deltaYears++;deltaMonths=newMonth-12;currentMonth=0}date.setYear(date.getFullYear()+deltaYears);var adjustedMonth=currentMonth+deltaMonths;if(date.getDate()>this.DAYS_IN_MONTH[adjustedMonth]){date.setDate(this.DAYS_IN_MONTH[adjustedMonth])}date.setMonth(adjustedMonth)},plusSeconds:function(date,number){if(number===0){return}var deltaMinutes=parseInt(number/60);Prime.Date.plusMinutes(date,deltaMinutes);var deltaSeconds=number%60;var newSecond=date.getSeconds()+deltaSeconds;if(newSecond>60){Prime.Date.plusMinutes(date,1);date.setSeconds(newSecond-60)}else if(newSecond<0){Prime.Date.plusMinutes(date,-1);date.setSeconds(60+newSecond)}else{date.setSeconds(newSecond)}},plusYears:function(date,number){if(number===0){return}date.setFullYear(date.getFullYear()+number)},toDateOnlyISOString:function(date){if(date instanceof Date){return date.toISOString().substring(0,10)}throw TypeError("date parameter must be a Date object.")}};"use strict";var Prime=Prime||{};Prime.Document=Prime.Document||{};Prime.Document.Element=function(element){if(!Prime.Utils.isDefined(element.nodeType)||element.nodeType!==1){throw new TypeError("You can only pass in DOM element Node objects to the Prime.Document.Element constructor")}Prime.Utils.bindAll(this);this.domElement=element;this.domElement.customEventListeners=[];this.domElement.eventListeners={}};Prime.Document.Element.blockElementRegexp=/^(?:ARTICLE|ASIDE|BLOCKQUOTE|BODY|BR|BUTTON|CANVAS|CAPTION|COL|COLGROUP|DD|DIV|DL|DT|EMBED|FIELDSET|FIGCAPTION|FIGURE|FOOTER|FORM|H1|H2|H3|H4|H5|H6|HEADER|HGROUP|HR|LI|MAP|OBJECT|OL|OUTPUT|P|PRE|PROGRESS|SECTION|TABLE|TBODY|TEXTAREA|TFOOT|TH|THEAD|TR|UL|VIDEO)$/;Prime.Document.Element.mouseEventsRegexp=/^(?:click|dblclick|mousedown|mouseup|mouseover|mousemove|mouseout)$/;Prime.Document.Element.htmlEventsRegexp=/^(?:abort|blur|change|error|focus|load|reset|resize|scroll|select|submit|unload)$/;Prime.Document.Element.anonymousId=1;Prime.Document.Element.ieAlpaRegexp=/alpha\(opacity=(.+)\)/;Prime.Document.Element.wrap=function(element){return element instanceof Prime.Document.Element?element:new Prime.Document.Element(element)};Prime.Document.Element.prototype={addClass:function(classNames){var currentClassName=this.domElement.className;if(currentClassName===""){currentClassName=classNames}else{var currentClassNameList=this.domElement.className.split(Prime.Utils.spaceRegex);var newClassNameList=classNames.split(Prime.Utils.spaceRegex);for(var i=0;i<newClassNameList.length;i++){if(currentClassNameList.indexOf(newClassNameList[i])===-1){currentClassNameList.push(newClassNameList[i])}}currentClassName=currentClassNameList.join(" ")}this.domElement.className=currentClassName;return this},addEventListener:function(event,listener){if(event.indexOf(":")===-1){this.domElement.eventListeners=this.domElement.eventListeners||{};this.domElement.eventListeners[event]=this.domElement.eventListeners[event]||[];if(this.domElement.eventListeners[event].indexOf(listener)===-1){this.domElement.eventListeners[event].push(listener)}this.domElement.addEventListener(event,listener,false)}else{this.domElement.customEventListeners=this.domElement.customEventListeners||{};this.domElement.customEventListeners[event]=this.domElement.customEventListeners[event]||[];if(this.domElement.customEventListeners[event].indexOf(listener)===-1){this.domElement.customEventListeners[event].push(listener)}}return this},appendElement:function(element){var domElement=element instanceof Prime.Document.Element?element.domElement:element;if(domElement.parentNode){domElement.parentNode.removeChild(domElement)}this.domElement.appendChild(domElement);return this},appendHTML:function(html){this.domElement.insertAdjacentHTML("beforeend",html);return this},appendTo:function(element){if(this.domElement.parentNode){throw new TypeError("You can only insert new Prime.Document.Elements for now")}var domElement=element instanceof Prime.Document.Element?element.domElement:element;if(domElement.parentNode){domElement.appendChild(this.domElement)}else{throw new TypeError("The element you passed into appendTo is not in the DOM. You can't insert a Prime.Document.Element inside an element that isn't in the DOM yet.")}return this},fireEvent:function(event,memo,target,bubbling,cancelable){memo=Prime.Utils.isDefined(memo)?memo:{};target=Prime.Utils.isDefined(target)?target:this;bubbling=Prime.Utils.isDefined(bubbling)?bubbling:true;cancelable=Prime.Utils.isDefined(cancelable)?cancelable:true;var evt;if(event.indexOf(":")===-1){if(document.createEventObject){evt=document.createEventObject();evt.memo=memo||{};evt.cancelBubble=!bubbling;this.domElement.fireEvent("on"+event,evt)}else if(document.createEvent){if(Prime.Document.Element.mouseEventsRegexp.exec(event)){evt=document.createEvent("MouseEvents");evt.initMouseEvent(event,bubbling,cancelable,window,0,0,0,0,0,false,false,false,false,0,null)}else if(Prime.Document.Element.htmlEventsRegexp.exec(event)){evt=document.createEvent("HTMLEvents");evt.initEvent(event,bubbling,cancelable)}else{throw new TypeError("Invalid event ["+event+"]")}evt.memo=memo||{};this.domElement.dispatchEvent(evt)}else{throw new TypeError("Unable to fire event. Neither createEventObject nor createEvent methods are available")}}else{this.domElement.customEventListeners[event]=this.domElement.customEventListeners[event]||[];evt={event:event,memo:memo,target:target};for(var index in this.domElement.customEventListeners[event]){if(this.domElement.customEventListeners[event].hasOwnProperty(index)){this.domElement.customEventListeners[event][index](evt)}}}return this},fireCustomEvent:function(event,eventObj){eventObj=Prime.Utils.isDefined(eventObj)?eventObj:{};if(event.indexOf(":")===-1){throw new TypeError("This method can only be used for custom events")}this.domElement.customEventListeners[event]=this.domElement.customEventListeners[event]||[];for(var index in this.domElement.customEventListeners[event]){if(this.domElement.customEventListeners[event].hasOwnProperty(index)){this.domElement.customEventListeners[event][index](eventObj)}}return this},focus:function(){this.domElement.focus();return this},getAbsoluteTop:function(){var top=0;var e=this.domElement;while(e){top+=e.offsetTop;e=e.offsetParent}return top},getAttribute:function(name){var attr=this.domElement.attributes.getNamedItem(name);if(attr){return attr.value}return null},getAttributes:function(){var attrs={};if(this.domElement.hasAttributes()){for(var i=0;i<this.domElement.attributes.length;i++){attrs[this.domElement.attributes[i].name]=this.domElement.attributes[i].value}}return attrs},getBottom:function(){return this.domElement.getBoundingClientRect().bottom},getChildren:function(selector){if(!Prime.Utils.isDefined(selector)){return new Prime.Document.ElementList(this.domElement.children)}var matched=[];for(var i=0;i<this.domElement.children.length;i++){var child=this.domElement.children[i];if(child.matches(selector)){matched.push(child)}}return new Prime.Document.ElementList(matched)},getClass:function(){return this.domElement.className},getComputedStyle:function(){return this.domElement.currentStyle?this.domElement.currentStyle:document.defaultView.getComputedStyle(this.domElement,null)},getDataSet:function(){if(this.domElement.dataset){return this.domElement.dataset}this.domElement.dataset={};var attrs=this.getAttributes();for(var prop in attrs){if(attrs.hasOwnProperty(prop)&&prop.indexOf("data-")===0){var dataName=prop.substring(5).replace(/-([a-z])/g,function(g){return g[1].toUpperCase()});this.domElement.dataset[dataName]=attrs[prop]}}return this.domElement.dataset},getDataAttribute:function(name){return this.getDataSet()[name]},getFirstChild:function(selector){var lastChild=this.getChildren(selector)[0];if(!Prime.Utils.isDefined(lastChild)){return null}return lastChild},getHeight:function(){var computedStyle=this.getComputedStyle();var offsetHeight=this.domElement.offsetHeight;var borderTop=computedStyle["borderTopWidth"];var borderBottom=computedStyle["borderBottomWidth"];return offsetHeight-Prime.Utils.parseCSSMeasure(borderTop)-Prime.Utils.parseCSSMeasure(borderBottom)},getHTML:function(){return this.domElement.innerHTML},getId:function(){return this.domElement.id},getLastChild:function(selector){var elementList=this.getChildren(selector);if(elementList.length>0){return elementList[elementList.length-1]}return null},getLeft:function(){return this.domElement.getBoundingClientRect().left},getNextSibling:function(){var sibling=this.domElement.nextSibling;while(sibling!==null&&sibling.nodeType!==1){sibling=sibling.nextSibling}if(sibling===null){return null}return new Prime.Document.Element(sibling)},getOffsetTop:function(){return this.domElement.offsetTop},getOpacity:function(){var computedStyle=this.getComputedStyle();var opacity=1;if(Prime.Browser.name==="Explorer"&&Prime.Browser.version<9){var filter=computedStyle["filter"];if(filter!==undefined&&filter!==""){var matches=Prime.Document.Element.ieAlpaRegexp.match(filter);if(matches.length>0){opacity=parseFloat(matches[0])}}}else{opacity=parseFloat(computedStyle["opacity"])}return opacity},getOptions:function(){if(this.getTagName()!=="SELECT"){throw new TypeError("You can only get the options for select elements")}return new Prime.Document.ElementList(this.domElement.options)},getOuterHeight:function(){var computedStyle=this.getComputedStyle();var offsetHeight=this.domElement.offsetHeight;var marginTop=computedStyle["marginTop"];var marginBottom=computedStyle["marginBottom"];return offsetHeight+Prime.Utils.parseCSSMeasure(marginTop)+Prime.Utils.parseCSSMeasure(marginBottom)},getOuterHTML:function(){return this.domElement.outerHTML},getOuterWidth:function(){var computedStyle=this.getComputedStyle();var offsetWidth=this.domElement.offsetWidth;var marginLeft=computedStyle["marginLeft"];var marginRight=computedStyle["marginRight"];return offsetWidth+Prime.Utils.parseCSSMeasure(marginLeft)+Prime.Utils.parseCSSMeasure(marginRight)},getParent:function(){if(Prime.Utils.isDefined(this.domElement.parentNode)){return new Prime.Document.Element(this.domElement.parentNode)}else{return null}},getPreviousSibling:function(){var sibling=this.domElement.previousSibling;while(sibling!==null&&sibling.nodeType!==1){sibling=sibling.previousSibling}if(sibling===null){return null}return new Prime.Document.Element(sibling)},getRight:function(){return this.domElement.getBoundingClientRect().right},getScrollHeight:function(){return this.domElement.scrollHeight},getScrollLeft:function(){return this.domElement.scrollLeft},getScrollTop:function(){return this.domElement.scrollTop},getScrollWidth:function(){return this.domElement.scrollWidth},getSelectedTexts:function(){var texts;if(this.domElement.tagName==="SELECT"){texts=[];for(var i=0;i<this.domElement.options.length;i++){if(this.domElement.options[i].selected){texts.push(this.domElement.options[i].text)}}}else{texts=null}return texts},getSelectedValues:function(){var values;if(this.domElement.tagName==="INPUT"&&(this.domElement.type==="checkbox"||this.domElement.type==="radio")){values=[];var name=this.domElement.name;var form=Prime.Document.queryUp("form",this.domElement);Prime.Document.query('input[name="'+name+'"]',form).each(function(element){if(element.isChecked()){values.push(element.getValue())}})}else if(this.domElement.tagName==="SELECT"){values=[];for(var i=0;i<this.domElement.length;i++){if(this.domElement.options[i].selected){values.push(this.domElement.options[i].value)}}}else{values=null}return values},getStyle:function(name){name=Prime.Utils.convertStyleName(name);return this.domElement.style[name]},getTagName:function(){return this.domElement.tagName},getTextContent:function(){return this.domElement.innerText?this.domElement.innerText:this.domElement.textContent},getTop:function(){return this.domElement.getBoundingClientRect().top},getWidth:function(){var computedStyle=this.getComputedStyle();var offsetWidth=this.domElement.offsetWidth;var borderLeft=computedStyle["borderLeftWidth"];var borderRight=computedStyle["borderRightWidth"];return offsetWidth-Prime.Utils.parseCSSMeasure(borderLeft)-Prime.Utils.parseCSSMeasure(borderRight)},getValue:function(){return this.domElement.value},hasClass:function(classNames){var currentClassNames=this.domElement.className;if(currentClassNames===""){return classNames===""}var currentClassNameList=currentClassNames.split(Prime.Utils.spaceRegex);var findClassNameList=classNames.split(Prime.Utils.spaceRegex);for(var i=0;i<findClassNameList.length;i++){if(currentClassNameList.indexOf(findClassNameList[i])===-1){return false}}return true},hide:function(){this.domElement.style.display="none";return this},insertAfter:function(element){if(this.domElement.parentNode){this.domElement.parentNode.removeChild(this.domElement)}var domElement=element instanceof Prime.Document.Element?element.domElement:element;var parentElement=domElement.parentNode;if(parentElement){parentElement.insertBefore(this.domElement,domElement.nextSibling)}else{throw new TypeError("The element you passed into insertAfter is not in the DOM. You can't insert a Prime.Document.Element after an element that isn't in the DOM yet.")}return this},insertBefore:function(element){if(this.domElement.parentNode){this.domElement.parentNode.removeChild(this.domElement)}var domElement=element instanceof Prime.Document.Element?element.domElement:element;var parentElement=domElement.parentNode;if(parentElement){parentElement.insertBefore(this.domElement,domElement)}else{throw new TypeError("The element you passed into insertBefore is not in the DOM. You can't insert a Prime.Document.Element before an element that isn't in the DOM yet.")}return this},insertHTMLAfter:function(html){this.domElement.insertAdjacentHTML("afterend",html);return this},insertHTMLAfterBegin:function(html){this.domElement.insertAdjacentHTML("afterbegin",html);return this},insertTextAfter:function(text){if(!this.domElement.parentNode){throw new TypeError("This Element is not currently in the DOM")}var textNode=document.createTextNode(text);this.domElement.parentNode.insertBefore(textNode,this.domElement.nextSibling);return this},insertTextBefore:function(text){if(!this.domElement.parentNode){throw new TypeError("This Element is not currently in the DOM")}var textNode=document.createTextNode(text);this.domElement.parentNode.insertBefore(textNode,this.domElement);return this},is:function(selector){return this.domElement.matches(selector)},isChecked:function(){return this.domElement.tagName==="INPUT"&&(this.domElement.type==="checkbox"||this.domElement.type==="radio")&&this.domElement.checked},isChildOf:function(element){var domElement=element instanceof Prime.Document.Element?element.domElement:element;var parent=this.domElement.parentNode;while(domElement!==parent&&parent!==null){parent=parent.parentNode}return domElement===parent},isDisabled:function(){return this.domElement.disabled},isFocused:function(){return document.activeElement===this.domElement},isInput:function(){var tagName=this.getTagName();return tagName==="SELECT"||tagName==="INPUT"||tagName==="TEXTAREA"},isInside:function(target){if(this.domElement===document.body||this.domElement===document.documentElement||this.domElement===document){return false}var parent=this.getParent();while(parent.domElement!==document.body){if(parent.domElement===target.domElement){return true}parent=parent.getParent()}return false},isSelected:function(){return this.domElement.tagName==="OPTION"&&this.domElement.selected},isVisible:function(){var computedStyle=this.getComputedStyle();return computedStyle["display"]!=="none"&&computedStyle["visibility"]!=="hidden"},prependTo:function(element){if(this.domElement.parentNode){throw new TypeError("You can only insert new Prime.Document.Elements for now")}var domElement=element instanceof Prime.Document.Element?element.domElement:element;if(domElement.parentNode){domElement.insertBefore(this.domElement,domElement.firstChild)}else{throw new TypeError("The element you passed into prependTo is not in the DOM. You can't insert a Prime.Document.Element inside an element that isn't in the DOM yet.")}return this},query:function(selector){return Prime.Document.query(selector,this)},queryFirst:function(selector){return Prime.Document.queryFirst(selector,this)},queryLast:function(selector){return Prime.Document.queryLast(selector,this)},queryUp:function(selector){return Prime.Document.queryUp(selector,this)},removeAllEventListeners:function(){for(var event in this.domElement.eventListeners){if(this.domElement.eventListeners.hasOwnProperty(event)){for(var i=0;i<this.domElement.eventListeners[event].length;i++){this._internalRemoveEventListener(event,this.domElement.eventListeners[event][i])}}}this.domElement.eventListeners={};this.domElement.customEventListeners={};return this},removeAttribute:function(name){this.domElement.removeAttribute(name);return this},removeClass:function(classNames){var currentClassName=this.domElement.className;if(currentClassName===""){return this}var currentClassNameList=currentClassName.split(Prime.Utils.spaceRegex);var removeClassNameList=classNames.split(Prime.Utils.spaceRegex);for(var i=0;i<removeClassNameList.length;i++){Prime.Utils.removeFromArray(currentClassNameList,removeClassNameList[i])}this.domElement.className=currentClassNameList.join(" ");return this},removeEventListener:function(event,listener){var listeners;if(event.indexOf(":")===-1){this._internalRemoveEventListener(event,listener);listeners=this.domElement.eventListeners[event]}else{listeners=this.domElement.customEventListeners[event]}if(listeners){Prime.Utils.removeFromArray(listeners,listener)}return this},removeEventListeners:function(event){if(event.indexOf(":")===-1){if(this.domElement.eventListeners[event]){for(var i=0;i<this.domElement.eventListeners[event].length;i++){this._internalRemoveEventListener(event,this.domElement.eventListeners[event][i])}delete this.domElement.eventListeners[event]}}else{if(this.domElement.customEventListeners[event]){delete this.domElement.customEventListeners[event]}}return this},removeEventListenersByPattern:function(pattern){for(var event in this.domElement.eventListeners){if(this.domElement.eventListeners.hasOwnProperty(event)&&pattern.test(event)){for(var i=0;i<this.domElement.eventListeners[event].length;i++){this._internalRemoveEventListener(event,this.domElement.eventListeners[event][i])}delete this.domElement.eventListeners[event]}}for(event in this.domElement.customEventListeners){if(this.domElement.customEventListeners.hasOwnProperty(event)&&pattern.test(event)){delete this.domElement.customEventListeners[event]}}return this},removeFromDOM:function(){if(this.domElement.parentNode){this.domElement.parentNode.removeChild(this.domElement)}return this},scrollIntoView:function(){this.domElement.scrollIntoView();return this},scrollLeftTo:function(position){this.domElement.scrollLeft=position;return this},scrollTo:function(position){this.domElement.scrollTop=position;return this},scrollToBottom:function(){this.domElement.scrollTop=this.domElement.scrollHeight;return this},scrollToTop:function(){this.domElement.scrollTop=0;return this},setAttribute:function(name,value){if(typeof value==="number"){value=value.toString()}if(this.domElement.setAttribute){this.domElement.setAttribute(name,value)}else{var attribute=document.createAttribute(name);attribute.nodeValue=value;this.domElement.setAttributeNode(attribute)}return this},setDataAttribute:function(name,value){var dataName="data-"+name.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return this.setAttribute(dataName,value)},setAttributes:function(attributes){for(var key in attributes){if(attributes.hasOwnProperty(key)){this.setAttribute(key,attributes[key])}}return this},setChecked:function(value){this.domElement.checked=value;return this},setDisabled:function(value){this.domElement.disabled=value;return this},setHeight:function(height){if(typeof height==="number"){height=height+"px"}this.setStyle("height",height);return this},setHTML:function(newHTML){if(newHTML!==null){if(newHTML instanceof Prime.Document.Element){this.domElement.innerHTML=newHTML.getHTML()}else{this.domElement.innerHTML=newHTML}}return this},setId:function(id){this.domElement.id=id;return this},setLeft:function(left){var leftString=left;if(typeof left==="number"){leftString=left+"px"}this.setStyle("left",leftString);return this},setOpacity:function(opacity){if(Prime.Browser.name==="Explorer"&&Prime.Browser.version<9){this.domElement.style.filter="alpha(opacity="+opacity+")"}else{this.domElement.style.opacity=opacity}return this},setSelected:function(selected){this.domElement.selected=selected},setSelectedValues:function(){var values=null;if(arguments.length===1&&Prime.Utils.isArray(arguments[0])){values=arguments[0]}else{values=Array.prototype.slice.call(arguments,0)}if(this.domElement.tagName==="INPUT"&&(this.domElement.type==="checkbox"||this.domElement.type==="radio")){var name=this.domElement.name;var form=Prime.Document.queryUp("form",this.domElement);Prime.Document.query('input[name="'+name+'"]',form).each(function(element){element.setChecked(values.indexOf(element.getValue())!==-1)})}else if(this.domElement.tagName==="SELECT"){for(var i=0;i<this.domElement.length;i++){this.domElement.options[i].selected=values.indexOf(this.domElement.options[i].value)!==-1}}return this},setStyle:function(name,value){if(typeof value==="number"){value=value.toString()}this.domElement.style[name]=value;return this},setStyles:function(styles){for(var key in styles){if(styles.hasOwnProperty(key)){this.setStyle(key,styles[key])}}return this},setTextContent:function(newText){if(newText!==null){if(newText instanceof Prime.Document.Element){this.domElement.textContent=newText.getTextContent()}else{if(typeof newText==="number"){newText=newText.toString()}this.domElement.textContent=newText}}return this},setTop:function(top){var topString=top;if(typeof top==="number"){topString=top+"px"}this.setStyle("top",topString);return this},setValue:function(value){if(typeof value==="number"){value=value.toString()}this.domElement.value=value;return this},setWidth:function(width){if(typeof width==="number"){width=width+"px"}this.setStyle("width",width);return this},show:function(displayValue){if(Prime.Utils.isDefined(displayValue)){this.domElement.style.display=displayValue;return this}this.domElement.style.display="";var computedDisplay=this.getComputedStyle()["display"];if(computedDisplay==="none"){if(!Prime.Utils.isDefined(displayValue)){displayValue=Prime.Document.Element.blockElementRegexp.test(this.domElement.tagName)?"block":"inline";
}this.domElement.style.display=displayValue}return this},toggleClass:function(className){if(this.hasClass(className)){this.removeClass(className)}else{this.addClass(className)}return this},unwrap:function(){var parent=this.getParent().domElement;while(this.domElement.firstChild){parent.insertBefore(this.domElement.firstChild,this.domElement)}this.removeFromDOM()},wrapInnerHTML:function(elementString,properties){var element=Prime.Document.newElement(elementString,properties);element.setHTML(this.getOuterHTML());this.domElement.outerHTML=element.domElement.outerHTML;return this},_internalRemoveEventListener:function(event,listener){if(event.indexOf(":")===-1){if(this.domElement.removeEventListener){this.domElement.removeEventListener(event,listener,false)}else if(this.domElement.detachEvent){this.domElement.detachEvent("on"+event,listener)}else{throw new TypeError("Unable to remove event from the element. Neither removeEventListener nor detachEvent methods are available")}}else if(this.domElement.customEventListeners[event]){var customListeners=this.domElement.customEventListeners[event];Prime.Utils.removeFromArray(customListeners,listener)}}};(function(){if(!Element.prototype.matches){Element.prototype.matches=function(selector){var domElement=this;var matches=(domElement.parentNode||domElement.document).querySelectorAll(selector);var i=0;while(matches[i]&&matches[i]!==domElement){i++}return matches[i]?true:false}}})();"use strict";var Prime=Prime||{};Prime.Document=Prime.Document||{};Prime.Document.ElementList=function(elements){Prime.Utils.bindAll(this);this.length=elements.length;for(var i=0;i<elements.length;i++){if(elements[i]instanceof Prime.Document.Element){this[i]=elements[i]}else{this[i]=new Prime.Document.Element(elements[i])}}};Prime.Document.ElementList.prototype={addClass:function(classNames){return this._proxyToElement("addClass",classNames)},addEventListener:function(event,listener){return this._proxyToElement("addEventListener",event,listener)},each:function(iterationFunction){for(var i=0;i<this.length;i++){iterationFunction(this[i],i)}return this},indexOf:function(element){var domElement=element instanceof Prime.Document.Element?element.domElement:element;for(var i=0;i<this.length;i++){if(this[i].domElement==domElement){return i}}return-1},removeAllFromDOM:function(){for(var i=0;i<this.length;i++){this[i].removeFromDOM()}return this},removeClass:function(classNames){return this._proxyToElement("removeClass",classNames)},setChecked:function(value){return this._proxyToElement("setChecked",value)},setDisabled:function(value){return this._proxyToElement("setDisabled",value)},_proxyToElement:function(){var args=Array.prototype.slice.apply(arguments);for(var i=0;i<this.length;i++){this[i][args[0]].apply(this[i],args.slice(1))}return this}};"use strict";var Prime=Prime||{};Prime.Document=Prime.Document||{};Prime.Document.readyFunctions=[];Prime.Document.tagRegexp=/^<(\w+)\s*\/?>.*(?:<\/\1>)?$/;Prime.Document.bodyElement=null;Prime.Document.addEventListener=function(event,listener){if(event.indexOf(":")===-1){document.eventListeners=document.eventListeners||{};document.eventListeners[event]=document.eventListeners[event]||[];document.eventListeners[event].push(listener);document.addEventListener(event,listener,false)}else{document.customEventListeners=document.customEventListeners||{};document.customEventListeners[event]=document.customEventListeners[event]||[];document.customEventListeners[event].push(listener)}return Prime.Document};Prime.Document.getHeight=function(){var body=document.body;var html=document.documentElement;return Math.max(body.scrollHeight,body.offsetHeight,html.clientHeight,html.scrollHeight,html.offsetHeight)};Prime.Document.getWidth=function(){var body=document.body;var html=document.documentElement;return Math.max(body.scrollWidth,body.offsetWidth,html.clientWidth,html.scrollWidth,html.offsetWidth)};Prime.Document.newDocument=function(documentString){return(new DOMParser).parseFromString(documentString,"text/html")};Prime.Document.newElement=function(elementString,properties){properties=Prime.Utils.isDefined(properties)?properties:{};var result=Prime.Document.tagRegexp.exec(elementString);if(result===null){throw new TypeError("Invalid string to create a new element ["+elementString+"]. It should look like <a/>")}var element=new Prime.Document.Element(document.createElement(result[1]));for(var key in properties){if(properties.hasOwnProperty(key)){if(key==="id"){element.setId(properties[key])}else{element.setAttribute(key,properties[key])}}}return element};Prime.Document.onReady=function(callback){if(document.readyState==="complete"){callback()}else{if(this.readyFunctions.length===0){if(document.addEventListener){document.addEventListener("DOMContentLoaded",Prime.Document._callReadyListeners,false)}else if(document.attachEvent){document.attachEvent("onreadystatechange",Prime.Document._callReadyListeners)}else{throw new TypeError("No way to attach an event to the document. What browser are you running?")}}this.readyFunctions.push(callback)}};Prime.Document.appendHTML=function(html){document.body.insertAdjacentHTML("beforeend",html)};Prime.Document.move=function(element,appendToElement){element=element instanceof Prime.Document.Element?element:new Prime.Document.Element(element);if(!Prime.Utils.isDefined(appendToElement)){appendToElement=new Prime.Document.Element(document.body)}else{appendToElement=appendToElement instanceof Prime.Document.Element?appendToElement:new Prime.Document.Element(appendToElement)}appendToElement.appendHTML(element.getOuterHTML());element.removeFromDOM();return appendToElement.getLastChild()};Prime.Document.query=function(selector,element){var domElement=null;if(!Prime.Utils.isDefined(element)){domElement=document}else{domElement=element instanceof Prime.Document.Element?element.domElement:element}var elements=domElement.querySelectorAll(selector);return new Prime.Document.ElementList(elements)};Prime.Document.queryById=function(id){var element=document.getElementById(id);if(!element){return null}return new Prime.Document.Element(element)};Prime.Document.queryFirst=function(selector,element){var domElement=null;if(!Prime.Utils.isDefined(element)){domElement=document}else{domElement=element instanceof Prime.Document.Element?element.domElement:element}domElement=domElement.querySelector(selector);if(domElement===null){return null}return new Prime.Document.Element(domElement)};Prime.Document.queryLast=function(selector,element){var domElement=null;if(!Prime.Utils.isDefined(element)){domElement=document}else{domElement=element instanceof Prime.Document.Element?element.domElement:element}var domElements=domElement.querySelectorAll(selector);if(domElements.length===0){return null}return new Prime.Document.Element(domElements[domElements.length-1])};Prime.Document.queryUp=function(selector,element){var domElement=null;if(!Prime.Utils.isDefined(element)){throw new SyntaxError("Missing required parameter. The element is required.")}else{domElement=element instanceof Prime.Document.Element?element.domElement:element}domElement=domElement.parentNode;while(domElement!==null&&!domElement.matches(selector)){domElement=domElement.parentNode;if(domElement===document){domElement=null}}if(domElement!==null){return new Prime.Document.Element(domElement)}return null};Prime.Document.removeEventListener=function(event,listener){if(document.removeEventListener){document.removeEventListener(event,listener,false)}else if(document.detachEvent){document.detachEvent("on"+event,listener)}else{throw new TypeError("Unable to remove event from the element. Neither removeEventListener nor detachEvent methods are available")}};Prime.Document._callReadyListeners=function(){if(document.addEventListener||document.readyState==="complete"){var readyFunction;while(readyFunction=Prime.Document.readyFunctions.shift()){readyFunction()}}if(document.removeEventListener){document.removeEventListener("DOMContentLoaded",Prime.Document._callReadyListeners,false)}else{document.detachEvent("onreadystatechange",Prime.Document._callReadyListeners)}};Prime.Document.onReady(function(){Prime.Document.bodyElement=new Prime.Document.Element(document.body)});(function(DOMParser){"use strict";var proto=DOMParser.prototype;var nativeParse=proto.parseFromString;try{if((new DOMParser).parseFromString("","text/html")){return}}catch(ex){}proto.parseFromString=function(markup,type){if(/^\s*text\/html\s*(?:;|$)/i.test(type)){var doc=document.implementation.createHTMLDocument("");if(markup.toLowerCase().indexOf("<!doctype")>-1){doc.documentElement.innerHTML=markup}else{doc.body.innerHTML=markup}return doc}else{return nativeParse.apply(this,arguments)}}})(DOMParser);"use strict";var Prime=Prime||{};Prime.Effects=Prime.Effects||{};Prime.Effects.BaseTransition=function(element,endValue){Prime.Utils.bindAll(this);this.element=Prime.Document.Element.wrap(element);this.duration=1e3;this.endFunction=null;this.endValue=endValue;this.iterations=20};Prime.Effects.BaseTransition.prototype={withEndFunction:function(endFunction){this.endFunction=endFunction;return this},withDuration:function(duration){if(duration<100){throw new TypeError("Duration should be greater than 100 milliseconds or it won't really be noticeable")}this.duration=duration;return this},_changeNumberStyleIteratively:function(getFunction,setFunction){var currentValue=getFunction.call(this.element);var step=Math.abs(this.endValue-currentValue)/this.iterations;var self=this;var stepFunction=function(last){if(last){currentValue=self.endValue}else{if(currentValue<self.endValue){currentValue+=step}else{currentValue-=step}}setFunction.call(self.element,currentValue)};Prime.Utils.callIteratively(this.duration,this.iterations,stepFunction,this._internalEndFunction)},_internalEndFunction:function(){if(this._subclassEndFunction){this._subclassEndFunction(this)}if(this.endFunction){this.endFunction(this)}}};Prime.Effects.Fade=function(element){Prime.Effects.BaseTransition.call(this,element,0)};Prime.Effects.Fade.prototype=Object.create(Prime.Effects.BaseTransition.prototype);Prime.Effects.Fade.constructor=Prime.Effects.Fade;Prime.Effects.Fade.prototype._subclassEndFunction=function(){this.element.hide()};Prime.Effects.Fade.prototype.go=function(){this._changeNumberStyleIteratively(this.element.getOpacity,this.element.setOpacity)};Prime.Effects.Appear=function(element,opacity){if(!Prime.Utils.isDefined(opacity)){opacity=1}Prime.Effects.BaseTransition.call(this,element,opacity)};Prime.Effects.Appear.prototype=Object.create(Prime.Effects.BaseTransition.prototype);Prime.Effects.Appear.constructor=Prime.Effects.Appear;Prime.Effects.Appear.prototype.go=function(){this.element.setOpacity(0);this.element.show();this._changeNumberStyleIteratively(this.element.getOpacity,this.element.setOpacity)};Prime.Effects.ScrollTo=function(element,position){this.axis="vertical";Prime.Effects.BaseTransition.call(this,element,position)};Prime.Effects.ScrollTo.prototype=Object.create(Prime.Effects.BaseTransition.prototype);Prime.Effects.ScrollTo.constructor=Prime.Effects.ScrollTo;Prime.Effects.ScrollTo.prototype.withAxis=function(axis){this.axis=axis||"vertical";return this};Prime.Effects.ScrollTo.prototype.go=function(){if(this.axis==="vertical"){this._changeNumberStyleIteratively(this.element.getScrollTop,this.element.scrollTo)}else{this._changeNumberStyleIteratively(this.element.getScrollLeft,this.element.scrollLeftTo)}};"use strict";var Prime=Prime||{};Prime.Events=Prime.Events||{};Prime.Events.Keys=Prime.Events.Keys||{};Prime.Events.Keys.BACKSPACE=8;Prime.Events.Keys.ENTER=13;Prime.Events.Keys.ESCAPE=27;Prime.Events.Keys.SPACE=32;Prime.Events.Keys.TAB=9;Prime.Events.Keys.LEFT_ARROW=37;Prime.Events.Keys.UP_ARROW=38;Prime.Events.Keys.RIGHT_ARROW=39;Prime.Events.Keys.DOWN_ARROW=40;Prime.Events.Keys.DELETE=46;"use strict";var Prime=Prime||{};Prime.Template=function(template){Prime.Utils.bindAll(this);this.init(template)};Prime.Template.prototype={init:function(template){this.template=template},generate:function(parameters){parameters=Prime.Utils.isDefined(parameters)?parameters:{};var templateCopy=new String(this.template);for(var key in parameters){if(parameters.hasOwnProperty(key)){var value=parameters[key];var expressedValue;if(typeof value==="function"){expressedValue=value()}else{expressedValue=value}if(key.indexOf("/")===0&&key.lastIndexOf("/")===key.length-1){templateCopy=templateCopy.replace(new RegExp(key.substring(1,key.length-1),"g"),expressedValue)}else{var expressedKey="#{"+key+"}";while(templateCopy.indexOf(expressedKey)!==-1){templateCopy=templateCopy.replace(expressedKey,expressedValue)}}}}return templateCopy},appendTo:function(primeElement,parameters){if(Prime.Utils.isDefined(primeElement)){primeElement.setHTML(primeElement.getHTML()+this.generate(parameters))}else{throw new TypeError("Please supply an element to append to")}},insertBefore:function(primeElement,parameters){if(Prime.Utils.isDefined(primeElement)){var holder=document.createElement("div");holder.innerHTML=this.generate(parameters);new Prime.Document.Element(holder.children[0]).insertBefore(primeElement)}else{throw new TypeError("Please supply an element to append to")}},insertAfter:function(primeElement,parameters){if(Prime.Utils.isDefined(primeElement)){var holder=document.createElement("div");holder.innerHTML=this.generate(parameters);new Prime.Document.Element(holder.children[0]).insertAfter(primeElement)}else{throw new TypeError("Please supply an element to append to")}}};"use strict";var Prime=Prime||{};Prime.Utils={spaceRegex:/\s+/,typeRegex:/^\[object\s(.*)\]$/,bindAll:function(object){for(var property in object){if(object[property]instanceof Function){object[property]=object[property].bind(object)}}},bindSome:function(object){if(arguments.length>1){for(var i=1;i<arguments.length;i++){var func=object[arguments[i]];if(!Prime.Utils.isDefined(func)||!(func instanceof Function)){throw new TypeError("The object does not contain a function named ["+arguments[i]+"]")}object[arguments[i]]=func.bind(object)}}for(var property in object){if(object[property]instanceof Function){object[property]=object[property].bind(object)}}},bindSafe:function(func,context){if(!Prime.Utils.isDefined(func)){throw new Error("Invalid arguments")}if(!Prime.Utils.isDefined(context)){return func}return func.bind(context)},calculateTextLength:function(element,text){var computedStyle=element.getComputedStyle();var textCalculator=Prime.Document.queryById("prime-text-calculator");if(textCalculator===null){textCalculator=Prime.Document.newElement("<span/>").setStyles({position:"absolute",width:"auto",fontSize:computedStyle["fontSize"],fontFamily:computedStyle["fontFamily"],fontWeight:computedStyle["fontWeight"],letterSpacing:computedStyle["letterSpacing"],whiteSpace:"nowrap"}).setId("prime-text-calculator").setTop(-9999).setLeft(-9999).appendTo(document.body)}textCalculator.setHTML(text);return textCalculator.getWidth()},callIteratively:function(totalDuration,timesToCall,stepFunction,endFunction){var step=totalDuration/timesToCall;var count=0;var id=setInterval(function(){count++;var last=count>=timesToCall;stepFunction(last);if(last){clearInterval(id);if(Prime.Utils.isDefined(endFunction)){endFunction()}}},step-1)},capitalize:function(str){return str.charAt(0).toUpperCase()+str.substring(1)},convertStyleName:function(name){if(name==="float"){return"cssFloat"}var dash=name.indexOf("-");if(dash===-1){return name}var start=0;var result="";while(dash!==-1){var piece=name.substring(start,dash);if(start===0){result=result.concat(piece)}else{result=result.concat(Prime.Utils.capitalize(piece))}start=dash+1;dash=name.indexOf("-",start)}return result+Prime.Utils.capitalize(name.substring(start))},dataSetToOptions:function(element){var options={};var data=element.getDataSet();for(var prop in data){if(!data.hasOwnProperty(prop)){continue}var value=data[prop];if(isNaN(value)){if(value==="true"){options[prop]=true}else if(value==="false"){options[prop]=false}else{options[prop]=value}}else{options[prop]=parseInt(value)}}return options},isArray:function(o){return Object.prototype.toString.call(o)==="[object Array]"},isDefined:function(value){return value!==null&&typeof value!=="undefined"},parseCSSMeasure:function(measure){var index=measure.indexOf("px");if(index>0){return parseInt(measure.substring(0,measure.length-2))}return parseInt(measure)||0},parseJSON:function(json){return JSON.parse(json)},removeAllFromArray:function(fromArray,toRemove){for(var i=0;i<toRemove.length;i++){Prime.Utils.removeFromArray(fromArray,toRemove[i])}},removeFromArray:function(array,obj){var index=array.indexOf(obj);if(index!==-1){var shift=array.splice(index+1,array.length);array.length=index;array.push.apply(array,shift)}},stopEvent:function(event){event.cancelBubble=true;if(event.stopPropagation){event.stopPropagation()}if(event.preventDefault){event.preventDefault()}},type:function(object){return Object.prototype.toString(object).match(Prime.Utils.typeRegex)[1]}};"use strict";var Prime=Prime||{};Prime.Widgets=Prime.Widgets||{};Prime.Widgets.DateTimePicker=function(element){this.element=Prime.Document.Element.wrap(element);if(!this.element.is("input")){throw new TypeError("You can only use Prime.Widgets.DateTimePicker with an input element")}Prime.Utils.bindAll(this);var value=this.element.getValue();if(value===""||value===null){this.date=new Date}else{this.date=new Date(value)}this._setInitialOptions();var year=this.date.getUTCFullYear();var timeSeparator="<span>"+Prime.Widgets.DateTimePicker.TIME_SEPARATOR+"</span>";var dateSeparator="<span>"+Prime.Widgets.DateTimePicker.DATE_SEPARATOR+"</span>";var html='<div class="prime-date-picker">'+'  <div class="header">'+'    <span class="prev">&#9664;</span>'+'    <span class="month"></span>'+'    <span class="year"></span>'+'    <span class="next">&#9654;</span>'+"  </div>"+'  <table class="month">'+"    <thead>"+"      <tr>"+"        <th>"+Prime.Widgets.DateTimePicker.SHORT_DAY_NAMES[0]+"</th>"+"        <th>"+Prime.Widgets.DateTimePicker.SHORT_DAY_NAMES[1]+"</th>"+"        <th>"+Prime.Widgets.DateTimePicker.SHORT_DAY_NAMES[2]+"</th>"+"        <th>"+Prime.Widgets.DateTimePicker.SHORT_DAY_NAMES[3]+"</th>"+"        <th>"+Prime.Widgets.DateTimePicker.SHORT_DAY_NAMES[4]+"</th>"+"        <th>"+Prime.Widgets.DateTimePicker.SHORT_DAY_NAMES[5]+"</th>"+"        <th>"+Prime.Widgets.DateTimePicker.SHORT_DAY_NAMES[6]+"</th>"+"      </tr>"+"    </thead>"+"    <tbody>"+"    </tbody>"+"  </table>"+'  <div class="inputs">'+'    <div class="date">'+'      <input size="2" maxlength="2" type="text" name="month" autocomplete="off"/>'+dateSeparator+'      <input size="2" maxlength="2" type="text" name="day" autocomplete="off"/>'+dateSeparator+'      <input size="4" maxlength="4" type="text" name="year" autocomplete="off"/>'+"    </div>"+'    <div class="time">'+'      <input size="2" maxlength="2" type="text" name="hour" autocomplete="off"/>'+timeSeparator+'      <input size="2" maxlength="2" type="text" name="minute" autocomplete="off"/>'+timeSeparator+'      <input size="2" maxlength="2" type="text" name="second" autocomplete="off"/>'+'      <input size="2" maxlength="2" type="text" name="am_pm" autocomplete="off"/>'+"    </div>"+"  </div>"+"</div>";Prime.Document.appendHTML(html);this.datepicker=Prime.Document.queryLast(".prime-date-picker").hide();this.element.addEventListener("click",this._handleInputClick);this.element.addEventListener("focus",this._handleInputClick);this.element.addEventListener("keydown",this._handleInputKey);this.calendarBody=this.datepicker.queryFirst("table tbody").addEventListener("click",this._handleDayClick);this.monthDisplay=this.datepicker.queryFirst(".header .month").addEventListener("click",this._handleMonthExpand);this.yearDisplay=this.datepicker.queryFirst(".header .year").addEventListener("click",this._handleYearExpand);this.time=this.datepicker.queryFirst(".time");this.inputs=this.datepicker.queryFirst("div.inputs");this.hourInput=this.inputs.queryFirst("input[name=hour]").addEventListener("change",this._handleDateTimeChange).addEventListener("keydown",this._handleHourKey);this.minuteInput=this.inputs.queryFirst("input[name=minute]").addEventListener("change",this._handleDateTimeChange).addEventListener("keydown",this._handleMinuteKey);this.secondInput=this.inputs.queryFirst("input[name=second]").addEventListener("change",this._handleDateTimeChange).addEventListener("keydown",this._handleSecondKey);this.ampmInput=this.inputs.queryFirst("input[name=am_pm]").addEventListener("keydown",this._handleAmPmKey);this.monthInput=this.inputs.queryFirst("input[name=month]").setValue(this.date.getMonth()+1).addEventListener("change",this._handleDateTimeChange).addEventListener("keydown",this._handleMonthKey);this.dayInput=this.inputs.queryFirst("input[name=day]").setValue(this.date.getDate()).addEventListener("change",this._handleDateTimeChange).addEventListener("keydown",this._handleDayKey);this.yearInput=this.inputs.queryFirst("input[name=year]").setValue(this.date.getFullYear()).addEventListener("change",this._handleDateTimeChange).addEventListener("keydown",this._handleYearKey);this.datepicker.queryFirst(".header .next").addEventListener("click",this._handleNextMonth);this.datepicker.queryFirst(".header .prev").addEventListener("click",this._handlePreviousMonth);this.callback=null;Prime.Document.addEventListener("click",this._handleGlobalClick);Prime.Document.addEventListener("keydown",this._handleGlobalKey);this.element.addClass("prime-initialized")};Prime.Widgets.DateTimePicker.SHORT_DAY_NAMES=["Su","Mo","Tu","We","Th","Fr","Sa"];Prime.Widgets.DateTimePicker.MONTHS=["January","February","March","April","May","June","July","August","September","October","November","December"];Prime.Widgets.DateTimePicker.DATE_SEPARATOR="/";Prime.Widgets.DateTimePicker.TIME_SEPARATOR=":";Prime.Widgets.DateTimePicker.AM_PM=["AM","PM"];Prime.Widgets.DateTimePicker.prototype={destroy:function(){this.datepicker.removeFromDOM();this.element.removeEventListener("click",this._handleInputClick);this.element.removeEventListener("focus",this._handleInputClick);this.element.removeEventListener("keydown",this._handleInputKey);Prime.Document.removeEventListener("click",this._handleGlobalClick);Prime.Document.removeEventListener("keydown",this._handleGlobalKey);this.element.removeClass("prime-initialized")},drawCalendar:function(date){var month=date.getMonth();var year=date.getFullYear();var firstDay=new Date(year,month,1);var firstDayOfMonth=firstDay.getDay();var daysInMonth=Prime.Date.numberOfDaysInMonth(year,month);var used=firstDayOfMonth+daysInMonth;var weeksInMonth=Math.ceil(used/7);var rows="";var startDay=1;for(var i=0;i<weeksInMonth;i++){var startDayOfWeek=i===0?firstDayOfMonth:0;rows+=this._buildCalendarWeek(date,startDayOfWeek,startDay,daysInMonth);startDay+=7-startDayOfWeek}this.calendarBody.setHTML(rows);this.monthDisplay.setDataAttribute("month",month);this.yearDisplay.setDataAttribute("year",year);this.monthDisplay.setTextContent(Prime.Widgets.DateTimePicker.MONTHS[month]);this.yearDisplay.setTextContent(year);return this},hide:function(){new Prime.Effects.Fade(this.datepicker).withDuration(100).go();return this},nextMonth:function(){var newDate=new Date(this.date);newDate.setDate(1);newDate.setMonth(parseInt(this.monthDisplay.getDataAttribute("month")));newDate.setFullYear(parseInt(this.yearDisplay.getDataAttribute("year")));Prime.Date.plusMonths(newDate,1);this.drawCalendar(newDate);return this},openMonthSelect:function(){this.months=this.datepicker.queryFirst(".months");if(Prime.Utils.isDefined(this.years)){this.years.hide()}if(this.months===null){var html='<div class="months">';for(var i=0;i<Prime.Widgets.DateTimePicker.MONTHS.length;i++){html+='<div data-month="'+i+'">'+Prime.Widgets.DateTimePicker.MONTHS[i]+"</div>"}html+="</div>";this.datepicker.appendHTML(html);this.months=this.datepicker.queryFirst(".months");this.months.getChildren().each(function(month){month.addEventListener("click",function(){new Prime.Effects.Fade(this.months).withDuration(100).go();this.setMonth(parseInt(month.getDataAttribute("month")))}.bind(this))}.bind(this))}new Prime.Effects.Appear(this.months).withDuration(100).go();this.months.setLeft(this.monthDisplay.getLeft()-10);this.months.setTop(this.monthDisplay.getAbsoluteTop());var currentMonth=this.months.queryFirst('[data-month="'+this.date.getMonth()+'"]');this.months.getChildren().each(function(month){month.removeClass("prime-selected")});currentMonth.addClass("prime-selected")},openYearSelect:function(){this.years=this.datepicker.queryFirst(".years");if(Prime.Utils.isDefined(this.months)){this.months.hide()}if(this.years===null){var html='<div class="years">';var startYear=this.date.getFullYear()-10;var endYear=this.date.getFullYear()+10;for(var i=startYear;i<endYear;i++){html+='<div data-year="'+i+'">'+i+"</div>"}html+="</div>";this.datepicker.appendHTML(html);this.years=this.datepicker.queryFirst(".years");this.years.getChildren().each(function(year){year.addEventListener("click",function(){new Prime.Effects.Fade(this.years).withDuration(100).go();this.setYear(parseInt(year.getDataAttribute("year")))}.bind(this))}.bind(this))}new Prime.Effects.Appear(this.years).withDuration(100).go();this.years.setLeft(this.yearDisplay.getLeft()-10);this.years.setTop(this.yearDisplay.getAbsoluteTop());var currentYear=this.years.queryFirst('[data-year="'+this.date.getFullYear()+'"]');this.years.getChildren().each(function(year){year.removeClass("prime-selected")});currentYear.addClass("prime-selected")},previousMonth:function(){var newDate=new Date(this.date);newDate.setDate(1);newDate.setMonth(parseInt(this.monthDisplay.getDataAttribute("month")));newDate.setFullYear(parseInt(this.yearDisplay.getDataAttribute("year")));Prime.Date.plusMonths(newDate,-1);this.drawCalendar(newDate);return this},render:function(){this.drawCalendar(this.date);this._refreshInputs();if(this.options.dateOnly){this.time.hide()}return this},setDate:function(newDate){this.date=newDate;if(this.options.dateOnly){this.element.setValue(Prime.Date.toDateOnlyISOString(newDate))}else{this.element.setValue(newDate.toISOString())}this.render();if(this.callback!==null){this.callback(this)}return this},setMonth:function(month){var currentYear=parseInt(this.yearDisplay.getDataAttribute("year"));if(month<0){month=11;currentYear--}else if(month>11){currentYear++;month=0}this.date.setMonth(month);this.date.setYear(currentYear);this.setDate(this.date);return this},setYear:function(year){this.yearDisplay.setDataAttribute("year",year);this.yearDisplay.setTextContent(year);this.date.setYear(year);this.setDate(this.date);return this},show:function(){this.datepicker.setLeft(this.element.getLeft());this.datepicker.setTop(this.element.getAbsoluteTop()+this.element.getHeight()+8);new Prime.Effects.Appear(this.datepicker).withDuration(200).go();return this},withCallback:function(callback){this.callback=callback;return this},withDateOnly:function(){this.options["dateOnly"]=true;return this},withOptions:function(options){if(!Prime.Utils.isDefined(options)){return this}for(var option in options){if(options.hasOwnProperty(option)){this.options[option]=options[option]}}return this},_buildCalendarWeek:function(date,startDayOfWeek,startDayOfMonth,daysInMonth){var daysInPreviousMonth=new Date(date.getFullYear(),date.getMonth(),0).getDate();var startDayOfPreviousMonth=daysInPreviousMonth-startDayOfWeek+1;var startDayOfNextMonth=1;var row="<tr>";var emptyColumns=0;var year=date.getFullYear();var month=date.getMonth();for(var i=0;i<7;i++){var dayOfWeek=startDayOfMonth+i;if(dayOfWeek<=startDayOfWeek){row+='<td><a class="prime-inactive" href="#" data-year="'+year+'" data-month="'+(month-1)+'" data-day="'+startDayOfPreviousMonth+'">'+startDayOfPreviousMonth+"</a></td>";startDayOfPreviousMonth++;emptyColumns++}else if(dayOfWeek>daysInMonth){row+='<td><a class="prime-inactive" href="#" data-year="'+year+'" data-month="'+month+'" data-day="'+dayOfWeek+'">'+startDayOfNextMonth+"</a></td>";startDayOfNextMonth++}else{var day=dayOfWeek-emptyColumns;var selected=this.date.getDate()===day&&this.date.getMonth()===month;row+="<td><a "+(selected?'class="prime-selected"':"")+'href="#" data-year="'+year+'" data-month="'+month+'" data-day="'+day+'">'+day+"</a></td>"}}row+="</tr>";return row},_clamp:function(min,max,value){return Math.max(min,Math.min(value,max))},_handleAmPmKey:function(event){if(event.keyCode===Prime.Events.Keys.TAB){if(event.shiftKey){this.secondInput.domElement.setSelectionRange(0,this.secondInput.getValue().length);this.secondInput.focus()}else{this.monthInput.domElement.setSelectionRange(0,this.monthInput.getValue().length);this.monthInput.focus()}Prime.Utils.stopEvent(event)}var current=this.ampmInput.getValue();if(event.keyCode===65){if(current===Prime.Widgets.DateTimePicker.AM_PM[1]){Prime.Date.plusHours(this.date,-12)}}else if(event.keyCode===80){if(current===Prime.Widgets.DateTimePicker.AM_PM[0]){Prime.Date.plusHours(this.date,12)}}else if(event.keyCode===Prime.Events.Keys.UP_ARROW||event.keyCode===Prime.Events.Keys.DOWN_ARROW){if(current===Prime.Widgets.DateTimePicker.AM_PM[0]){Prime.Date.plusHours(this.date,12)}else if(current===Prime.Widgets.DateTimePicker.AM_PM[1]){Prime.Date.plusHours(this.date,-12)}}else if(event.keyCode===Prime.Events.Keys.ENTER||event.keyCode===Prime.Events.Keys.ESCAPE){return}this.setDate(this.date);this.ampmInput.domElement.setSelectionRange(0,this.ampmInput.getValue().length);Prime.Utils.stopEvent(event)},_handleDateTimeChange:function(event){var newDate=new Date;var hours=this._clamp(1,12,parseInt(this.hourInput.getValue()));if(this.ampmInput.getValue()===Prime.Widgets.DateTimePicker.AM_PM[0]){if(hours===12){newDate.setHours(0)}else{newDate.setHours(hours)}}else{if(hours===12){newDate.setHours(12)}else{newDate.setHours(hours+12)}}var seconds=this._clamp(0,59,parseInt(this.secondInput.getValue()));var minutes=this._clamp(0,59,parseInt(this.minuteInput.getValue()));newDate.setSeconds(seconds);newDate.setMinutes(minutes);newDate.setDate(1);newDate.setMonth(parseInt(this.monthInput.getValue())-1);newDate.setDate(parseInt(this.dayInput.getValue()));newDate.setYear(parseInt(this.yearInput.getValue()));this.setDate(newDate);Prime.Utils.stopEvent(event)},_handleDayClick:function(event){var dayElement=new Prime.Document.Element(event.target);if(!dayElement.is("a")){dayElement=dayElement.queryFirst("a")}var newDate=new Date(this.date);newDate.setDate(1);newDate.setFullYear(parseInt(dayElement.getDataAttribute("year")));newDate.setMonth(parseInt(dayElement.getDataAttribute("month")));newDate.setDate(parseInt(dayElement.getDataAttribute("day")));this.setDate(newDate);Prime.Utils.stopEvent(event)},_handleDayKey:function(event){if(event.keyCode===Prime.Events.Keys.UP_ARROW){Prime.Date.plusDays(this.date,1);this.setDate(this.date);this.dayInput.domElement.setSelectionRange(0,this.dayInput.getValue().length);Prime.Utils.stopEvent(event)}else if(event.keyCode===Prime.Events.Keys.DOWN_ARROW){Prime.Date.plusDays(this.date,-1);this.setDate(this.date);this.dayInput.domElement.setSelectionRange(0,this.dayInput.getValue().length);Prime.Utils.stopEvent(event)}else if(event.keyCode===Prime.Events.Keys.ENTER){this.date.setDate(parseInt(this.dayInput.getValue()))}},_handleGlobalClick:function(event){if(event.target===this.element.domElement){return}var top=this.datepicker.getTop();var bottom=this.datepicker.getBottom();var left=this.datepicker.getLeft();var right=this.datepicker.getRight();if(this.datepicker.isVisible()&&(event.x<left||event.x>right||event.y<top||event.y>bottom)){if(Prime.Utils.isDefined(this.years)){this.years.hide()}if(Prime.Utils.isDefined(this.months)){this.months.hide()}this.hide()}},_handleGlobalKey:function(event){if(!this.datepicker.isVisible()){return}if(event.keyCode===Prime.Events.Keys.ENTER){this.setDate(this.date);this.hide();this.element.focus();Prime.Utils.stopEvent(event)}else if(event.keyCode===Prime.Events.Keys.ESCAPE){
this.hide();this.element.focus()}},_handleHourKey:function(event){if(event.keyCode===Prime.Events.Keys.UP_ARROW){Prime.Date.plusHours(this.date,1);this.setDate(this.date);this.hourInput.domElement.setSelectionRange(0,this.hourInput.getValue().length);Prime.Utils.stopEvent(event)}else if(event.keyCode===Prime.Events.Keys.DOWN_ARROW){Prime.Date.plusHours(this.date,-1);this.setDate(this.date);this.hourInput.domElement.setSelectionRange(0,this.hourInput.getValue().length);Prime.Utils.stopEvent(event)}else if(event.keyCode===Prime.Events.Keys.ENTER){this.date.setHours(parseInt(this.hourInput.getValue()))}Prime.Utils.stopEvent(event)},_handleInputClick:function(){if(!this.datepicker.isVisible()){this.show();this.monthInput.domElement.setSelectionRange(0,this.monthInput.getValue().length);this.monthInput.focus()}},_handleInputKey:function(event){if(this.datepicker.isVisible()&&event.keyCode===Prime.Events.Keys.TAB){if(event.shiftKey){this.ampmInput.domElement.setSelectionRange(0,this.ampmInput.getValue().length);this.ampmInput.focus()}else{this.monthInput.domElement.setSelectionRange(0,this.monthInput.getValue().length);this.monthInput.focus()}Prime.Utils.stopEvent(event)}},_handleMinuteKey:function(event){if(event.keyCode===Prime.Events.Keys.UP_ARROW){Prime.Date.plusMinutes(this.date,1);this.setDate(this.date);this.minuteInput.domElement.setSelectionRange(0,this.minuteInput.getValue().length);Prime.Utils.stopEvent(event)}else if(event.keyCode===Prime.Events.Keys.DOWN_ARROW){Prime.Date.plusMinutes(this.date,-1);this.setDate(this.date);this.minuteInput.domElement.setSelectionRange(0,this.minuteInput.getValue().length);Prime.Utils.stopEvent(event)}else if(event.keyCode===Prime.Events.Keys.ENTER){this.date.setMinutes(parseInt(this.minuteInput.getValue()))}},_handleMonthExpand:function(){this.openMonthSelect()},_handleMonthKey:function(event){if(event.keyCode===Prime.Events.Keys.TAB&&event.shiftKey){if(this.options.dateOnly){this.yearInput.domElement.setSelectionRange(0,this.yearInput.getValue().length);this.yearInput.focus()}else{this.ampmInput.domElement.setSelectionRange(0,this.ampmInput.getValue().length);this.ampmInput.focus()}Prime.Utils.stopEvent(event)}if(event.keyCode===Prime.Events.Keys.UP_ARROW){Prime.Date.plusMonths(this.date,1);this.setDate(this.date);this.monthInput.domElement.setSelectionRange(0,this.monthInput.getValue().length);Prime.Utils.stopEvent(event)}else if(event.keyCode===Prime.Events.Keys.DOWN_ARROW){Prime.Date.plusMonths(this.date,-1);this.setDate(this.date);this.monthInput.domElement.setSelectionRange(0,this.monthInput.getValue().length);Prime.Utils.stopEvent(event)}else if(event.keyCode===Prime.Events.Keys.ENTER){this.date.setMonth(parseInt(this.monthInput.getValue())-1)}},_handleNextMonth:function(event){this.nextMonth();Prime.Utils.stopEvent(event)},_handlePreviousMonth:function(event){this.previousMonth();Prime.Utils.stopEvent(event)},_handleSecondKey:function(event){if(event.keyCode===Prime.Events.Keys.UP_ARROW){Prime.Date.plusSeconds(this.date,1);this.setDate(this.date);this.secondInput.domElement.setSelectionRange(0,this.secondInput.getValue().length);Prime.Utils.stopEvent(event)}else if(event.keyCode===Prime.Events.Keys.DOWN_ARROW){Prime.Date.plusSeconds(this.date,-1);this.setDate(this.date);this.secondInput.domElement.setSelectionRange(0,this.secondInput.getValue().length);Prime.Utils.stopEvent(event)}else if(event.keyCode===Prime.Events.Keys.ENTER){this.date.setSeconds(parseInt(this.secondInput.getValue()))}},_handleYearExpand:function(){this.openYearSelect()},_handleYearKey:function(event){if(event.keyCode===Prime.Events.Keys.UP_ARROW){Prime.Date.plusYears(this.date,1);this.setDate(this.date);this.yearInput.domElement.setSelectionRange(0,this.yearInput.getValue().length);Prime.Utils.stopEvent(event)}else if(event.keyCode===Prime.Events.Keys.DOWN_ARROW){Prime.Date.plusYears(this.date,-1);this.setDate(this.date);this.yearInput.domElement.setSelectionRange(0,this.yearInput.getValue().length);Prime.Utils.stopEvent(event)}else if(event.keyCode===Prime.Events.Keys.TAB&&this.options.dateOnly){if(event.shiftKey){this.dayInput.domElement.setSelectionRange(0,this.dayInput.getValue().length);this.dayInput.focus()}else{this.monthInput.domElement.setSelectionRange(0,this.monthInput.getValue().length);this.monthInput.focus()}Prime.Utils.stopEvent(event)}else if(event.keyCode===Prime.Events.Keys.ENTER){this.date.setFullYear(parseInt(this.yearInput.getValue()))}},_refreshInputs:function(){var hours=Prime.Date.getHourOfDay(this.date);this.hourInput.setValue(hours);var minutes=this.date.getMinutes();this.minuteInput.setValue(("00"+minutes).slice(-2));var seconds=this.date.getSeconds();this.secondInput.setValue(("00"+seconds).slice(-2));if(this.date.getHours()>=12){this.ampmInput.setValue(Prime.Widgets.DateTimePicker.AM_PM[1])}else{this.ampmInput.setValue(Prime.Widgets.DateTimePicker.AM_PM[0])}this.monthInput.setValue(this.date.getMonth()+1);this.dayInput.setValue(this.date.getDate());this.yearInput.setValue(this.date.getFullYear())},_setInitialOptions:function(){this.options={dateOnly:false};var userOptions=Prime.Utils.dataSetToOptions(this.element);for(var option in userOptions){if(userOptions.hasOwnProperty(option)){this.options[option]=userOptions[option]}}}};"use strict";var Prime=Prime||{};Prime.Widgets=Prime.Widgets||{};Prime.Widgets.Draggable=function(element,gripSelector){Prime.Utils.bindAll(this);this.element=Prime.Document.Element.wrap(element);if(!Prime.Utils.isDefined(gripSelector)){this.grip=this.element}else{this.grip=this.element.queryFirst(gripSelector);if(this.grip===null){throw Error("Unable to find an element using the provided selector ["+gripSelector+"]")}}this.grip.addClass("prime-draggable-grip");this.originalStyle={cursor:this.element.getStyle("cursor"),"z-index":this.element.getStyle("z-index")};this.offset={};this.grip.addEventListener("mousedown",this._handleMouseDown);this.element.addEventListener("mouseup",this._handleOnMouseUp);this.parent=new Prime.Document.Element(this.element.domElement.parentNode);this.parent.addEventListener("mouseup",this._handleParentMouseUp);this.element.addClass("prime-draggable")};Prime.Widgets.Draggable.prototype={destroy:function(){this.element.removeClass("prime-draggable prime-draggable-active");this.element.setStyles(this.originalStyle)},_handleMouseDown:function(event){this.element.addClass("prime-draggable-active");this.offset={z_index:this.element.getStyle("z-index"),height:this.element.getOuterHeight(),width:this.element.getOuterWidth(),x:this.element.getLeft()+this.element.getOuterWidth()-event.pageX,y:this.element.getTop()+this.element.getOuterHeight()-event.pageY};this.element.setStyle("z-index",this.offset.z_index+1e3);this.parent.removeEventListener("mousemove",this._handleParentMouseMove);this.parent.addEventListener("mousemove",this._handleParentMouseMove);event.preventDefault()},_handleParentMouseMove:function(event){this.element.setLeft(event.pageX+this.offset.x-this.offset.width);this.element.setTop(event.pageY+this.offset.y-this.offset.height)},_handleParentMouseUp:function(){this.element.removeClass("prime-draggable-active");this.element.setStyle("z-index",this.offset.z_index)},_handleOnMouseUp:function(){this.parent.removeEventListener("mousemove",this._handleParentMouseMove);this.element.removeClass("prime-draggable-active")}};"use strict";var Prime=Prime||{};Prime.Widgets=Prime.Widgets||{};Prime.Widgets.MultipleSelect=function(element){this.element=Prime.Document.Element.wrap(element);if(this.element.domElement.tagName!=="SELECT"){throw new TypeError("You can only use Prime.Widgets.MultipleSelect with select elements")}if(this.element.getAttribute("multiple")!=="multiple"){throw new TypeError('The select box you are attempting to convert to a Prime.Widgets.MultipleSelect must have the multiple="multiple" attribute set')}Prime.Utils.bindAll(this);this.element.hide();this.placeholder="Choose";this.noSearchResultsLabel="No Matches For: ";this.customAddEnabled=true;this.customAddLabel="Add Custom Value: ";var id=this.element.getId();if(id===null||id===""){id="prime-multiple-select"+Prime.Widgets.MultipleSelect.count++;this.element.setId(id)}this.displayContainer=Prime.Document.queryById(id+"-display");this.input=null;if(this.displayContainer===null){this.displayContainer=Prime.Document.newElement("<div/>").setId(id+"-display").addClass("prime-multiple-select-display").addEventListener("click",this._handleClickEvent).addEventListener("keyup",this._handleKeyUpEvent).insertAfter(this.element);this.displayContainerSelectedOptionList=Prime.Document.newElement("<ul/>").addClass("prime-multiple-select-option-list").appendTo(this.displayContainer);this.searchResultsContainer=Prime.Document.newElement("<ul/>").addClass("prime-multiple-select-search-result-list").hide().appendTo(this.displayContainer)}else{this.displayContainer.removeAllEventListeners().addEventListener("click",this._handleClickEvent).addEventListener("keyup",this._handleKeyUpEvent);this.displayContainerSelectedOptionList=Prime.Document.queryFirst(".prime-multiple-select-option-list",this.displayContainer);this.searchResultsContainer=Prime.Document.queryFirst(".prime-multiple-select-search-result-list",this.displayContainer)}Prime.Document.queryFirst("html").addEventListener("click",this._handleGlobalClickEvent)};Prime.Widgets.MultipleSelect.count=1;Prime.Widgets.MultipleSelect.AddOptionEvent="Prime:Widgets:MultipleSelect:addOption";Prime.Widgets.MultipleSelect.DeselectOptionEvent="Prime:Widgets:MultipleSelect:deselectOption";Prime.Widgets.MultipleSelect.SelectOptionEvent="Prime:Widgets:MultipleSelect:selectOption";Prime.Widgets.MultipleSelect.prototype={addEventListener:function(event,listener){this.element.addEventListener(event,listener);return this},addOption:function(value,display){if(this.containsOptionWithValue(value)){return this}Prime.Document.newElement("<option/>").setValue(value).setHTML(display).appendTo(this.element);this.element.fireEvent(Prime.Widgets.MultipleSelect.AddOptionEvent,value,this);return this},containsOptionWithValue:function(value){return this.findOptionWithValue(value)!==null},deselectOption:function(option){option.setSelected(false);var id=this._makeOptionID(option);var displayOption=Prime.Document.queryById(id);if(displayOption!==null){displayOption.removeFromDOM()}if(Prime.Document.query(".prime-multiple-select-option",this.displayContainerSelectedOptionList).length===0){this.input.setAttribute("placeholder",this.placeholder);this.searcher.resizeInput()}this.element.fireEvent(Prime.Widgets.MultipleSelect.DeselectOptionEvent,option.getValue(),this);return this},deselectOptionWithValue:function(value){var option=this.findOptionWithValue(value);if(option===null){throw new Error("MultipleSelect doesn't contain an option with the value ["+value+"]")}this.deselectOption(option);return this},findOptionWithText:function(text){var options=this.element.getOptions();for(var i=0;i<options.length;i++){if(options[i].getTextContent()===text){return options[i]}}return null},findOptionWithValue:function(value){for(var i=0;i<this.element.domElement.length;i++){var cur=this.element.domElement.options[i];if(cur.value===value){return new Prime.Document.Element(cur)}}return null},getSelectedValues:function(){return this.element.getSelectedValues()},hasOptionWithValue:function(value){return this.findOptionWithValue(value)!==null},highlightOptionForUnselect:function(){var options=this.displayContainerSelectedOptionList.getChildren();if(options.length>1){options[options.length-2].addClass("prime-multiple-select-option-highlighted")}return this},isLastOptionHighlightedForUnselect:function(){var options=this.displayContainerSelectedOptionList.getChildren();return options.length>1&&options[options.length-2].hasClass("prime-multiple-select-option-highlighted")},removeAllOptions:function(){var options=this.element.domElement.options;for(var i=options.length-1;i>=0;i--){this.removeOption(new Prime.Document.Element(options[i]))}return this},removeHighlightedOption:function(){var options=this.displayContainerSelectedOptionList.getChildren();this.deselectOptionWithValue(options[options.length-2].getAttribute("value"));this.search(null)},removeOption:function(option){if(!(option instanceof Prime.Document.Element)){throw new TypeError("MultipleSelect#removeOption only takes Prime.Document.Element instances")}option.removeFromDOM();var id=this._makeOptionID(option);var displayOption=Prime.Document.queryById(id);if(displayOption!==null){displayOption.removeFromDOM()}return this},removeOptionWithValue:function(value){var option=this.findOptionWithValue(value);if(option===null){throw new Error("MultipleSelect doesn't contain an option with the value ["+value+"]")}this.removeOption(option);return this},render:function(){this.searchResultsContainer.hide();this.displayContainerSelectedOptionList.getChildren().each(function(option){option.removeFromDOM()});this.inputOption=Prime.Document.newElement("<li/>").addClass("prime-multiple-select-input-option").appendTo(this.displayContainerSelectedOptionList);this.input=Prime.Document.newElement("<input/>").addClass("prime-multiple-select-input").addEventListener("click",this._handleClickEvent).addEventListener("blur",this._handleBlurEvent).setAttribute("type","text").appendTo(this.inputOption);this.searcher=new Prime.Widgets.Searcher(this.input,this.searchResultsContainer,this).withCustomAddEnabled(this.customAddEnabled).withCustomAddLabel(this.customAddLabel).withNoSearchResultsLabel(this.noSearchResultsLabel);var hasSelectedOptions=false;var options=this.element.getOptions();for(var i=0;i<options.length;i++){var option=options[i];if(option.isSelected()){this.selectOption(option);hasSelectedOptions=true}}if(!hasSelectedOptions){this.input.setAttribute("placeholder",this.placeholder)}this.searcher.resizeInput();return this},selectOption:function(option){if(!(option instanceof Prime.Document.Element)){throw new TypeError("MultipleSelect#selectOption only takes Prime.Document.Element instances")}var id=this._makeOptionID(option);if(Prime.Document.queryById(id)===null){option.setSelected(true);var li=Prime.Document.newElement("<li/>").addClass("prime-multiple-select-option").setAttribute("value",option.getValue()).setId(id).insertBefore(this.inputOption);Prime.Document.newElement("<span/>").setHTML(option.getHTML()).setAttribute("value",option.getValue()).appendTo(li);Prime.Document.newElement("<a/>").setAttribute("href","#").setAttribute("value",option.getValue()).addClass("prime-multiple-select-remove-option").setHTML("X").addEventListener("click",this._handleClickEvent).appendTo(li)}this.input.removeAttribute("placeholder");this.searcher.closeSearchResults();this.displayContainerSelectedOptionList.scrollToBottom();this.element.fireEvent(Prime.Widgets.MultipleSelect.SelectOptionEvent,option.getValue(),this);return this},selectOptionWithValue:function(value){var option=this.findOptionWithValue(value);if(option===null){throw new Error("MultipleSelect doesn't contain an option with the value ["+value+"]")}this.selectOption(option);return this},setSelectedValues:function(){this.element.setSelectedValues.apply(this.element,arguments);this.render();return this},unhighlightOptionForUnselect:function(){this.displayContainerSelectedOptionList.getChildren().each(function(element){element.removeClass("prime-multiple-select-option-highlighted")});return this},withCustomAddEnabled:function(enabled){this.customAddEnabled=enabled;return this},withCustomAddLabel:function(customAddLabel){this.customAddLabel=customAddLabel;return this},withNoSearchResultsLabel:function(noSearchResultsLabel){this.noSearchResultsLabel=noSearchResultsLabel;return this},withPlaceholder:function(placeholder){this.placeholder=placeholder;return this},deletedBeyondSearchInput:function(){if(this.isLastOptionHighlightedForUnselect()){this.removeHighlightedOption()}this.highlightOptionForUnselect()},doesNotContainValue:function(value){return!this.containsOptionWithValue(value)},search:function(searchText){this.unhighlightOptionForUnselect();var options=this.element.domElement.options;var selectableOptions=[];for(var i=0;i<options.length;i++){var option=new Prime.Document.Element(options[i]);if(option.isSelected()){continue}var html=option.getHTML();if(searchText===null||searchText===""||html.toLowerCase().indexOf(searchText.toLowerCase())===0){selectableOptions.push(html)}}if(selectableOptions.length>0){selectableOptions.sort()}return{results:selectableOptions,tooManyResults:false}},selectSearchResult:function(value){var option=this.findOptionWithText(value);if(option===null){this.addOption(value,value);option=this.findOptionWithText(value)}this.selectOption(option)},_handleBlurEvent:function(){window.setTimeout(function(){if(document.activeElement!==this.input.domElement){this.searcher.closeSearchResults()}}.bind(this),300)},_handleClickEvent:function(event){var target=new Prime.Document.Element(event.currentTarget);if(this.displayContainer.domElement===target.domElement){this.input.focus()}else if(target.hasClass("prime-multiple-select-remove-option")){this.removeOptionWithValue(target.getAttribute("value"))}else if(this.input.domElement!==target.currentTarget){console.log("Clicked something else target=["+event.target+"] currentTarget=["+event.currentTarget+"]")}},_handleGlobalClickEvent:function(event){var target=new Prime.Document.Element(event.target);if(this.displayContainer.domElement!==target.domElement&&!target.isChildOf(this.displayContainer)){this.searcher.closeSearchResults()}},_handleKeyUpEvent:function(event){var key=event.keyCode;if(key===Prime.Events.Keys.ESCAPE){this.unhighlightOptionForUnselect()}},_makeOptionID:function(option){return this.element.getId()+"-option-"+option.getValue().replace(" ","-")}};"use strict";var Prime=Prime||{};Prime.Widgets=Prime.Widgets||{};Prime.Widgets.PhraseBuilder=function(element,searchCallback){this.element=Prime.Document.Element.wrap(element);this.customAddEnabled=false;if(this.element.domElement.tagName!=="SELECT"){throw new TypeError("You can only use Prime.Widgets.PhraseBuilder with select elements")}if(this.element.getAttribute("multiple")!=="multiple"){throw new TypeError('The select box you are attempting to convert to a Prime.Widgets.PhraseBuilder must have the multiple="multiple" attribute set')}Prime.Utils.bindAll(this);this.element.hide();this.searchCallback=searchCallback;var id=this.element.getId();if(id===null||id===""){id="prime-phrase-builder"+Prime.Widgets.PhraseBuilder.count++;this.element.setId(id)}this.placeholder="Type Words for Phrase Here";this.customAddLabel=null;this.displayContainer=Prime.Document.queryById(id+"-display");this.input=null;if(this.displayContainer===null){this.displayContainer=Prime.Document.newElement("<div/>").setId(id+"-display").addClass("prime-phrase-builder-display").addEventListener("click",this._handleClickEvent).addEventListener("keyup",this._handleKeyUpEvent).insertAfter(this.element);this.displayContainerSelectedOptionList=Prime.Document.newElement("<ul/>").addClass("prime-phrase-builder-option-list").appendTo(this.displayContainer);this.searchResultsContainer=Prime.Document.newElement("<ul/>").addClass("prime-phrase-builder-search-result-list").hide().appendTo(this.displayContainer)}else{this.displayContainer.removeAllEventListeners().addEventListener("click",this._handleClickEvent).addEventListener("keyup",this._handleKeyUpEvent);this.displayContainerSelectedOptionList=Prime.Document.queryFirst(".prime-phrase-builder-option-list",this.displayContainer);this.searchResultsContainer=Prime.Document.queryFirst(".prime-phrase-builder-search-result-list",this.displayContainer)}Prime.Document.queryFirst("html").addEventListener("click",this._handleGlobalClickEvent)};Prime.Widgets.PhraseBuilder.count=1;Prime.Widgets.PhraseBuilder.prototype={addWord:function(word){if(this.containsWord(word)){return this}var option=Prime.Document.newElement("<option/>").setValue(word).setHTML(word).setAttribute("selected","selected").appendTo(this.element);this._addSelectedOptionToDisplay(option);this.input.removeAttribute("placeholder");this.searcher.closeSearchResults();this.displayContainerSelectedOptionList.scrollToBottom();return this},containsWord:function(word){return this._findOptionForWord(word)!==null},getWords:function(){return this.element.getSelectedValues()},highlightWordForRemoval:function(){var options=this.displayContainerSelectedOptionList.getChildren();if(options.length>1){options[options.length-2].addClass("prime-phrase-builder-option-highlighted")}return this},isLastWordHighlightedForRemoval:function(){var options=this.displayContainerSelectedOptionList.getChildren();return options.length>1&&options[options.length-2].hasClass("prime-phrase-builder-option-highlighted")},removeAllWords:function(){var options=this.element.domElement.options;for(var i=options.length-1;i>=0;i--){this.removeWord(new Prime.Document.Element(options[i]).getTextContent())}return this},removeHighlightedWord:function(){var options=this.displayContainerSelectedOptionList.getChildren();this.removeWord(options[options.length-2].getAttribute("value"))},removeWord:function(word){var option=this._findOptionForWord(word);if(option===null){return this}option.removeFromDOM();var id=this._makeOptionID(option);var displayOption=Prime.Document.queryById(id);if(displayOption!==null){displayOption.removeFromDOM()}if(Prime.Document.query(".prime-phrase-builder-option",this.displayContainerSelectedOptionList).length===0){this.input.setAttribute("placeholder",this.placeholder);this.searcher.resizeInput()}return this},render:function(){this.displayContainerSelectedOptionList.getChildren().each(function(option){option.removeFromDOM()});this.inputOption=Prime.Document.newElement("<li/>").addClass("prime-phrase-builder-input-option").appendTo(this.displayContainerSelectedOptionList);this.input=Prime.Document.newElement("<input/>").addClass("prime-phrase-builder-input").setAttribute("type","text").appendTo(this.inputOption);this.searcher=new Prime.Widgets.Searcher(this.input,this.searchResultsContainer,this).withCustomAddEnabled(this.customAddEnabled);if(this.customAddEnabled){this.searcher.withCustomAddCallback(this.customAddCallback)}if(this.customAddLabel!==null){this.searcher.withCustomAddLabel(this.customAddLabel)}for(var i=0;i<this.element.domElement.length;i++){var option=this._createOption(this.element.domElement.options[i]);this._addSelectedOptionToDisplay(option)}if(this.element.domElement.length===0){this.input.setAttribute("placeholder",this.placeholder)}this.searcher.closeSearchResults();return this},_createOption:function(option){return new Prime.Document.Element(option).setAttribute("selected","selected")},unhighlightWordForRemoval:function(){this.displayContainerSelectedOptionList.getChildren().each(function(element){element.removeClass("prime-phrase-builder-option-highlighted")});return this},withPlaceholder:function(placeholder){this.placeholder=placeholder;return this},withCustomAdd:function(callback){this.customAddEnabled=true;if(callback===undefined){this.customAddCallback=function(){return true}}else{this.customAddCallback=callback}return this},withCustomAddLabel:function(customAddLabel){this.customAddLabel=customAddLabel;return this},deletedBeyondSearchInput:function(){if(this.isLastWordHighlightedForRemoval()){this.removeHighlightedWord()}this.highlightWordForRemoval()},search:function(searchText){this.unhighlightWordForRemoval();return this.searchCallback(searchText,this.getWords())},selectSearchResult:function(value){this.addWord(value)},_addSelectedOptionToDisplay:function(option){var id=this._makeOptionID(option);if(Prime.Document.queryById(id)===null){var li=Prime.Document.newElement("<li/>").addClass("prime-phrase-builder-option").setAttribute("value",option.getValue()).setId(id).insertBefore(this.inputOption);Prime.Document.newElement("<span/>").setHTML(option.getHTML()).setAttribute("value",option.getValue()).appendTo(li);Prime.Document.newElement("<a/>").setAttribute("href","#").setAttribute("value",option.getValue()).addClass("prime-phrase-builder-remove-option").setHTML("X").addEventListener("click",this._handleClickEvent).appendTo(li)}},_findOptionForWord:function(word){var options=this.element.getOptions();for(var i=0;i<options.length;i++){if(options[i].getTextContent()===word){return options[i]}}return null},_handleClickEvent:function(event){var target=new Prime.Document.Element(event.currentTarget);if(this.displayContainer.domElement===target.domElement){this.searcher.focus()}else if(target.hasClass("prime-phrase-builder-remove-option")){this.removeWord(target.getAttribute("value"))}else{console.log("Clicked something else target=["+event.target+"] currentTarget=["+event.currentTarget+"]")}Prime.Utils.stopEvent(event)},_handleFocusEvent:function(){this.search()},_handleGlobalClickEvent:function(event){var target=new Prime.Document.Element(event.target);if(this.displayContainer.domElement!==target.domElement&&!target.isChildOf(this.displayContainer)){this.searcher.closeSearchResults()}},_handleKeyUpEvent:function(event){var key=event.keyCode;if(key===Prime.Events.Keys.ESCAPE){this.unhighlightWordForRemoval()}},_makeOptionID:function(option){return this.element.getId()+"-option-"+option.getValue().replace(" ","-")}};Prime.Widgets.PhraseBuilderSupportsDupes=function(element,searchCallback){Prime.Widgets.PhraseBuilder.call(this,element,searchCallback)};Prime.Widgets.PhraseBuilderSupportsDupes.prototype=Object.create(Prime.Widgets.PhraseBuilder.prototype);Prime.Widgets.PhraseBuilderSupportsDupes.constructor=Prime.Widgets.PhraseBuilderSupportsDupes;Prime.Widgets.PhraseBuilderSupportsDupes.prototype.addWord=function(word){var option=Prime.Document.newElement("<option/>").setValue(word).setHTML(word).setAttribute("selected","selected").setDataAttribute("display-id",""+Math.random()+1).appendTo(this.element);this._addSelectedOptionToDisplay(option);this.input.removeAttribute("placeholder");this.searcher.closeSearchResults();this.displayContainerSelectedOptionList.scrollToBottom();return this};Prime.Widgets.PhraseBuilderSupportsDupes.prototype._makeOptionID=function(option){return option.getDataAttribute("displayId")};Prime.Widgets.PhraseBuilderSupportsDupes.prototype._createOption=function(option){return new Prime.Document.Element(option).setAttribute("selected","selected").setDataAttribute("display-id",""+Math.random()+1)};"use strict";var Prime=Prime||{};Prime.Widgets=Prime.Widgets||{};Prime.Widgets.Searcher=function(inputElement,searchResultsContainer,callbackObject){this.inputElement=Prime.Document.Element.wrap(inputElement);if(this.inputElement.domElement.tagName!=="INPUT"){throw new TypeError("You can only use Prime.Widgets.SearchResults with INPUT elements")}Prime.Utils.bindAll(this);this.inputElement.addClass("prime-searcher-input").addEventListener("blur",this._handleBlurEvent).addEventListener("click",this._handleClickEvent).addEventListener("keyup",this._handleKeyUpEvent).addEventListener("keydown",this._handleKeyDownEvent).addEventListener("focus",this._handleFocusEvent);this.searchResultsContainer=searchResultsContainer instanceof Prime.Document.Element?searchResultsContainer:new Prime.Document.Element(searchResultsContainer);this.searchResultsContainer.addClass("prime-searcher-search-results-list");this.noSearchResultsLabel="No Matches For: ";this.tooManySearchResultsLabel="Too Many Matches For: ";this.customAddEnabled=true;this.customAddCallback=function(){return true};this.customAddLabel="Add Custom: ";this.callbackObject=callbackObject;this.closeSearchResults()};Prime.Widgets.Searcher.prototype={closeSearchResults:function(){this._removeAllSearchResults();this.searchResultsContainer.hide();this.inputElement.setValue("");this.resizeInput()},focus:function(){this.inputElement.focus()},getHighlightedSearchResult:function(){return Prime.Document.queryFirst(".prime-searcher-highlighted-search-result",this.searchResultsContainer)},highlightNextSearchResult:function(){var searchResult=this.getHighlightedSearchResult();if(searchResult!==null){searchResult=searchResult.getNextSibling()}if(searchResult===null){searchResult=Prime.Document.queryFirst(".prime-searcher-search-result",this.searchResultsContainer)}if(searchResult!==null){this.highlightSearchResult(searchResult)}return this},highlightPreviousSearchResult:function(){var searchResult=this.getHighlightedSearchResult();if(searchResult!==null){searchResult=searchResult.getPreviousSibling()}if(searchResult===null){searchResult=Prime.Document.queryLast(".prime-searcher-search-result",this.searchResultsContainer)}if(searchResult!==null){this.highlightSearchResult(searchResult)}return this},highlightSearchResult:function(searchResult){this.searchResultsContainer.getChildren().each(function(element){element.removeClass("prime-searcher-highlighted-search-result")});searchResult.addClass("prime-searcher-highlighted-search-result");var scrollTop=this.searchResultsContainer.getScrollTop();var height=this.searchResultsContainer.getHeight();var searchResultOffset=searchResult.getOffsetTop();if(searchResultOffset+1>=scrollTop+height){this.searchResultsContainer.scrollTo(searchResult.getOffsetTop()-this.searchResultsContainer.getHeight()+searchResult.getOuterHeight())}else if(searchResultOffset<scrollTop){this.searchResultsContainer.scrollTo(searchResultOffset)}return this},isCustomAddVisible:function(){return Prime.Document.queryFirst(".prime-searcher-add-custom",this.searchResultsContainer)!==null},isSearchResultsVisible:function(){return this.searchResultsContainer.isVisible()},resizeInput:function(){var text=this.inputElement.getValue()===""?this.inputElement.getAttribute("placeholder"):this.inputElement.getValue();var newLength=Prime.Utils.calculateTextLength(this.inputElement,text)+35;this.inputElement.setWidth(newLength)},search:function(searchText){if(Prime.Utils.isDefined(searchText)&&this.inputElement.getValue()!==searchText){this.inputElement.setValue(searchText)}searchText=Prime.Utils.isDefined(searchText)?searchText.toLowerCase():this.inputElement.getValue();this.resizeInput();this._removeAllSearchResults();var searchResults=this.callbackObject.search(searchText);if(!searchResults.hasOwnProperty("results")||!searchResults.hasOwnProperty("tooManyResults")){throw new TypeError("The callback must return an Object that contains the properties results[Array] and tooManyResults[boolean]")}var count=0;var matchingSearchResultElement=null;for(var i=0;i<searchResults.results.length;i++){var searchResult=searchResults.results[i];var element=Prime.Document.newElement("<li/>").addClass("prime-searcher-search-result").setAttribute("value",searchResult).setHTML(searchResult).addEventListener("click",this._handleClickEvent).addEventListener("mouseover",this._handleMouseOverEvent).appendTo(this.searchResultsContainer);if(searchResult.toLowerCase().trim()===searchText.toLowerCase().trim()){matchingSearchResultElement=element}count++}var trimmedLength=searchText.trim().length;if(this.customAddEnabled&&trimmedLength!==0&&matchingSearchResultElement===null&&(!("doesNotContainValue"in this.callbackObject)||this.callbackObject.doesNotContainValue(searchText))){matchingSearchResultElement=Prime.Document.newElement("<li/>").addClass("prime-searcher-search-result prime-searcher-add-custom").addEventListener("click",this._handleClickEvent).addEventListener("mouseover",this._handleMouseOverEvent).setHTML(this.customAddLabel+searchText).appendTo(this.searchResultsContainer);count++}if(count===0&&trimmedLength!==0){Prime.Document.newElement("<li/>").addClass("prime-searcher-no-search-results").setHTML(this.noSearchResultsLabel+searchText).appendTo(this.searchResultsContainer);count++}if(searchResults.tooManyResults){Prime.Document.newElement("<li/>").addClass("prime-searcher-too-many-search-results").setHTML(this.tooManySearchResultsLabel+searchText).appendTo(this.searchResultsContainer);count++}if(count!==0){this.searchResultsContainer.show();
if(count>=10){this.searchResultsContainer.setHeight(this.searchResultsContainer.getChildren()[0].getOuterHeight()*10+1)}else{this.searchResultsContainer.setHeight(this.searchResultsContainer.getChildren()[0].getOuterHeight()*count+1)}}else{this.searchResultsContainer.hide()}if(matchingSearchResultElement!==null){this.highlightSearchResult(matchingSearchResultElement)}return this},selectHighlightedSearchResult:function(){var searchResult=this.getHighlightedSearchResult();if(searchResult===null){return this}var custom=searchResult.hasClass("prime-searcher-add-custom");var value=custom?this.inputElement.getValue().trim():searchResult.getHTML();if(custom){if(!this.customAddCallback(value)){return this}}this.callbackObject.selectSearchResult(value);this.closeSearchResults();return this},withCustomAddEnabled:function(enabled){this.customAddEnabled=enabled;return this},withCustomAddCallback:function(callback){this.customAddCallback=callback;return this},withCustomAddLabel:function(customAddLabel){this.customAddLabel=customAddLabel;return this},withTooManySearchResultsLabel:function(tooManySearchResultsLabel){this.tooManySearchResultsLabel=tooManySearchResultsLabel;return this},withNoSearchResultsLabel:function(noSearchResultsLabel){this.noSearchResultsLabel=noSearchResultsLabel;return this},_handleBlurEvent:function(){window.setTimeout(function(){if(document.activeElement!==this.inputElement.domElement){this.closeSearchResults()}}.bind(this),300)},_handleClickEvent:function(event){var target=new Prime.Document.Element(event.currentTarget);if(target.hasClass("prime-searcher-add-custom")||target.hasClass("prime-searcher-search-result")){this.selectHighlightedSearchResult()}else if(target.domElement===this.inputElement.domElement){this.search()}else{console.log("Clicked something else target=["+event.target+"] currentTarget=["+event.currentTarget+"]")}},_handleFocusEvent:function(){this.search()},_handleKeyDownEvent:function(event){var key=event.keyCode;if(key===Prime.Events.Keys.BACKSPACE){this.previousSearchString=this.inputElement.getValue()}else if(key===Prime.Events.Keys.UP_ARROW){this.highlightPreviousSearchResult();Prime.Utils.stopEvent(event)}else if(key===Prime.Events.Keys.DOWN_ARROW){if(this.isSearchResultsVisible()){this.highlightNextSearchResult()}else{this.search()}Prime.Utils.stopEvent(event)}else if(key===Prime.Events.Keys.ENTER){Prime.Utils.stopEvent(event)}},_handleKeyUpEvent:function(event){var key=event.keyCode;var value=this.inputElement.getValue();if(key==Prime.Events.Keys.BACKSPACE){if(value===""&&this.previousSearchString===""){this.callbackObject.deletedBeyondSearchInput()}else{this.search()}}else if(key===Prime.Events.Keys.ENTER){if(this.getHighlightedSearchResult()!==null){this.selectHighlightedSearchResult()}Prime.Utils.stopEvent(event)}else if(key===Prime.Events.Keys.ESCAPE){this.searchResultsContainer.hide()}else if(key===Prime.Events.Keys.SPACE||key===Prime.Events.Keys.DELETE||key>=48&&key<=90||key>=96&&key<=111||key>=186&&key<=192||key>=219&&key<=222){this.search()}},_handleMouseOverEvent:function(event){var target=new Prime.Document.Element(event.currentTarget);this.highlightSearchResult(target)},_removeAllSearchResults:function(){Prime.Document.query("li",this.searchResultsContainer).removeAllFromDOM()}};"use strict";var Prime=Prime||{};Prime.Widgets=Prime.Widgets||{};Prime.Widgets.SideMenu=function(button,mainBody){Prime.Utils.bindAll(this);this.body=new Prime.Document.Element(document.body);Prime.Document.Element.wrap(button).addEventListener("click",this._handleClickEvent);Prime.Document.Element.wrap(mainBody).addClass("prime-side-menu-body")};Prime.Widgets.SideMenu.constructor=Prime.Widgets.SideMenu;Prime.Widgets.SideMenu.prototype={copyFromElement:function(element){var sideMenu=Prime.Document.newElement("<nav/>").prependTo(this.body).setId("prime-side-menu").addClass("prime-side-menu").setHTML(element.getHTML());sideMenu.query("a").each(function(e){e.addEventListener("click",this._handleTOCClickEvent)}.bind(this))},close:function(){this.body.removeClass("prime-side-menu-open")},isOpen:function(){return this.body.hasClass("prime-side-menu-open")},open:function(){this.body.addClass("prime-side-menu-open");this.touchable=new Prime.Widgets.Touchable(this.body).withSwipeLeftHandler(this._handleSwipeLeft)},usingSideMenuElement:function(sideMenuElement){sideMenuElement=Prime.Document.Element.wrap(sideMenuElement);sideMenuElement.query("a").each(function(e){e.addEventListener("click",this._handleTOCClickEvent)}.bind(this))},_handleClickEvent:function(event){if(this.isOpen()){this.close()}else{this.open()}Prime.Utils.stopEvent(event)},_handleSwipeLeft:function(){if(this.isOpen()){this.close()}if(Prime.Utils.isDefined(this.touchable)){this.touchable.destroy();this.touchable=null}},_handleTOCClickEvent:function(){this.close()}};"use strict";var Prime=Prime||{};Prime.Widgets=Prime.Widgets||{};Prime.Widgets.SplitButton=function(element){this.element=Prime.Document.Element.wrap(element);var nodeName=this.element.domElement.nodeName.toLowerCase();if(nodeName!=="ul"){throw new TypeError("SplitButton requires a ul element. The passed element type is <"+nodeName+">")}if(this.element.hasClass("prime-initialized")){throw new Error("This element has already been initialized. Call destroy before initializing again.")}Prime.Utils.bindAll(this);this.element.hide().addClass("prime-split-button");this.container=Prime.Document.queryUp("div,td",this.element);this.defaultAction=this.element.queryFirst("ul > li.default a");if(this.defaultAction===null){this.defaultAction=this.element.queryFirst("ul > li a")}this._buildSplitButton();this.splitButton.addEventListener("mouseover",this._handleMouseOver);this.splitButton.addEventListener("mouseout",this._handleMouseOut);this.element.addEventListener("mouseout",this._handleMouseOut);this.dropDown.addEventListener("click",this._handleDropDownClick);this.dropDownDiv.addEventListener("click",this._handleDropDownClick);this.defaultButton.addEventListener("click",this._handleDefaultButton);var body=new Prime.Document.Element(document.body);if(!body.getAttribute("data-prime-split-button-handler")){body.addEventListener("click",this._hideAllButtons);body.setAttribute("data-prime-split-button-handler","true")}this.element.addClass("prime-initialized")};Prime.Widgets.SplitButton.constructor=Prime.Widgets.SplitButton;Prime.Widgets.SplitButton.prototype={destroy:function(){this.splitButton.removeAllEventListeners();this.dropDown.removeAllEventListeners();this.splitButton.removeFromDOM();this.element.removeEventListener("mouseout",this._handleMouseOut);this.element.removeAttribute("data-prime-active");this.element.setStyle("margin-top","");this.element.removeClass("prime-initialized prime-split-button").show();this.defaultAction.show()},_handleDefaultButton:function(event){this.defaultAction.fireEvent("click",null,null,false,true);Prime.Utils.stopEvent(event)},_handleDropDownClick:function(event){this._clearActiveMarker();this._setActiveMarker();this._hideAllButtons();if(this.element.isVisible()){this.element.hide();this.splitButton.addClass("prime-inactive")}else{this.element.setStyle("margin-top",this.dropDownDiv.getHeight()+2+"px");this.element.show();var width=1;this.splitButton.getChildren("div").each(function(element){width+=element.getWidth()});this.element.setWidth(width);this.splitButton.removeClass("prime-inactive")}Prime.Utils.stopEvent(event)},_handleMouseOver:function(){this.splitButton.removeClass("prime-inactive")},_handleMouseOut:function(){if(!this.element.isVisible()){this.splitButton.addClass("prime-inactive")}},_buildSplitButton:function(){var div=Prime.Document.newElement("<div>");div.addClass("prime-split-button prime-inactive");div.prependTo(this.container);this.splitButton=Prime.Document.queryFirst("div.prime-split-button",this.container);var buttonDiv=Prime.Document.newElement("<div>");var button=Prime.Document.newElement("<a>");button.addClass("prime-split-button-default");button.setAttribute("href",this.defaultAction.getAttribute("href"));button.setHTML(this.defaultAction.getHTML());if(button.getAttribute("href")==="#"){button.addEventListener("click",this._handleDropDownClick);this.defaultAction.getParent().hide()}var dropDownDiv=Prime.Document.newElement("<div>");var dropDown=Prime.Document.newElement("<a>");dropDown.addClass("prime-drop-down");dropDownDiv.prependTo(this.splitButton);dropDownDiv=Prime.Document.queryLast("div",this.splitButton);dropDown.prependTo(dropDownDiv.domElement);buttonDiv.prependTo(this.splitButton);buttonDiv=Prime.Document.queryFirst("div",this.splitButton);button.prependTo(buttonDiv.domElement);this.defaultButton=Prime.Document.queryFirst("div",this.splitButton);this.dropDown=Prime.Document.queryFirst("a.prime-drop-down",this.splitButton);this.dropDownDiv=Prime.Document.queryUp("div",this.dropDown);this.element.setStyle("margin-top",this.dropDown.getHeight()+"")},_clearActiveMarker:function(){Prime.Document.query("ul.prime-split-button.prime-initialized[data-prime-active]").each(function(element){element.removeAttribute("data-prime-active")})},_hideAllButtons:function(event){Prime.Document.query("ul.prime-split-button.prime-initialized").each(function(element){if(!Prime.Utils.isDefined(event)){if(!element.domElement.hasAttribute("data-prime-active")&&element.isVisible()){element.hide()}}else{if(element.isVisible()){element.hide()}}});Prime.Document.query("div.prime-split-button:not(.prime-inactive)").each(function(element){element.addClass("prime-inactive")})},_setActiveMarker:function(){this.element.setAttribute("data-prime-active","true")}};"use strict";var Prime=Prime||{};Prime.Widgets=Prime.Widgets||{};Prime.Widgets.Tabs=function(element){this.element=Prime.Document.Element.wrap(element);if(this.element.getTagName().toLowerCase()==="ul"){this.tabsContainer=this.element}else{this.tabsContainer=this.element.queryFirst("ul")}if(this.tabsContainer===null){throw new TypeError("Tabs requires a ul element. The passed element does not contain a ul element")}if(this.tabsContainer.hasClass("prime-initialized")){throw new Error("This element has already been initialized. Call destroy before initializing again.")}Prime.Utils.bindAll(this);this._setInitialOptions();this.tabsContainer.hide().addClass("prime-tabs");this.tabContents={};this.tabs={};this.tabArray=[];this.selectedTab=null;this.selectHandler=null;this.tabsContainer.query("li:not(.prime-disabled)").each(function(tab){var a=tab.queryFirst("a").addEventListener("click",this._handleClick);var dataSet=tab.getDataSet();var href=a.getAttribute("href");var isAnchor=href.charAt(0)==="#";if(isAnchor){dataSet.tabId=href.substring(1);dataSet.tabURL=""}else{dataSet.tabId=href;dataSet.tabURL=href}this.tabs[dataSet.tabId]=tab;this.tabArray.push(tab);var content=Prime.Document.queryById(dataSet.tabId);if(content===null&&isAnchor){throw new Error("A div is required with the following ID ["+dataSet.tabId+"]")}else if(content===null){content=Prime.Document.newElement("<div>").insertAfter(this.element).setAttribute("id",href)}content.hide();content.addClass("prime-tab-content");this.tabContents[dataSet.tabId]=content}.bind(this));this.tabsContainer.addClass("prime-initialized")};Prime.Widgets.Tabs.prototype={destroy:function(){this.tabsContainer.getChildren().each(function(tab){var a=Prime.Document.queryFirst("a",tab);a.removeEventListener("click",this._handleClick)}.bind(this));for(var i=0;i<this.tabs.length;i++){this.tabs[i].removeClass("prime-tab-content")}this.tabsContainer.removeClass("prime-tabs prime-initialized")},hideTab:function(id){var tab=this.tabs[id];tab.hide();this.redraw()},redraw:function(){var firstVisible=null;var lastVisible=null;var selectNew=false;var noneActive=true;for(var i=0;i<this.tabArray.length;i++){if(this.tabArray[i].isVisible()){if(firstVisible===null){firstVisible=this.tabArray[i]}lastVisible=this.tabArray[i];if(this.tabArray[i].hasClass("prime-active")){noneActive=false}}else if(this.tabArray[i].hasClass("prime-active")){selectNew=true}this.tabArray[i].removeClass("first-child last-child")}firstVisible.addClass("first-child");lastVisible.addClass("last-child");var tabId=null;if(selectNew||noneActive){if(this.localStorageSupported&&this.options["localStorageKey"]!==null){var item=sessionStorage.getItem(this.options["localStorageKey"]);if(item!==null){tabId=JSON.parse(item).tabId}}if(tabId===null||!this.tabs[tabId]||!this.tabs[tabId].isVisible()){tabId=firstVisible.getDataSet().tabId}this.selectTab(tabId)}if(this.options.errorClass){for(tabId in this.tabContents){if(this.tabContents.hasOwnProperty(tabId)){var errorElement=this.tabContents[tabId].queryFirst("."+this.options.errorClass);if(errorElement!==null){this.tabs[tabId].queryFirst("a").addClass(this.options.errorClass);this.selectTab(tabId)}}}}},render:function(){this.localStorageSupported=Prime.Utils.isDefined(Storage)&&this.options["localStorageKey"]!==null;this.tabsContainer.show();this.redraw();return this},selectTab:function(id){if(this.selectedTab!==null&&this.selectedTab.getDataSet().tabId===id){return}for(var tabId in this.tabs){if(this.tabs.hasOwnProperty(tabId)){this.tabs[tabId].removeClass("prime-active")}}this.tabs[id].addClass("prime-active");this.selectedTab=this.tabs[id];for(tabId in this.tabContents){if(this.tabContents.hasOwnProperty(tabId)&&tabId===id){this.tabContents[tabId].show();if(this.selectHandler){this.selectHandler(this.tabs[tabId],this.tabContents[tabId])}}else{this.tabContents[tabId].hide()}}if(this.localStorageSupported){var data={tabId:id};sessionStorage.setItem(this.options["localStorageKey"],JSON.stringify(data))}var ajaxURL=this.selectedTab.getDataSet().tabURL;if(ajaxURL!==""){this.selectedTab.addClass("prime-loading");this.tabContents[id].setHTML("");this.tabContents[id].addClass("prime-loading");new Prime.Ajax.Request(ajaxURL,"GET").withSuccessHandler(this._handleAJAXResponse).withErrorHandler(this._handleAJAXResponse).go()}},showTab:function(id){this.tabs[id].show();this.redraw()},withAJAXCallback:function(callback){this.options["ajaxCallback"]=callback;return this},withErrorClassHandling:function(errorClass){this.options["errorClass"]=errorClass;return this},withLocalStorageKey:function(key){this.options["localStorageKey"]=key;return this},withSelectHandler:function(func){this.selectHandler=func;return this},withOptions:function(options){if(!Prime.Utils.isDefined(options)){return this}for(var option in options){if(options.hasOwnProperty(option)){this.options[option]=options[option]}}return this},_handleAJAXResponse:function(xhr){this.selectedTab.removeClass("prime-loading");var container=this.tabContents[this.selectedTab.getDataSet().tabId];container.removeClass("prime-loading");container.setHTML(xhr.responseText);if(this.options["ajaxCallback"]!==null){this.options["ajaxCallback"](container)}},_handleClick:function(event){var a=new Prime.Document.Element(event.currentTarget);if(!a.hasClass("prime-disabled")){var href=a.getAttribute("href");if(href.charAt(0)==="#"){this.selectTab(href.substring(1))}else{this.selectTab(href)}}Prime.Utils.stopEvent(event)},_setInitialOptions:function(){this.options={ajaxCallback:null,errorClass:null,localStorageKey:null};var userOptions=Prime.Utils.dataSetToOptions(this.element);for(var option in userOptions){if(userOptions.hasOwnProperty(option)){this.options[option]=userOptions[option]}}}};"use strict";var Prime=Prime||{};Prime.Widgets=Prime.Widgets||{};Prime.Widgets.Touchable=function(element,eventPropagationHandler){Prime.Utils.bindAll(this);this.eventPropagationHandler=eventPropagationHandler;this.element=Prime.Document.Element.wrap(element);this.element.addEventListener("touchstart",this._handleTouchStart).addEventListener("touchmove",this._handleTouchMove).addEventListener("touchcancel",this._handleTouchCancel).addEventListener("touchend",this._handleTouchEnd)};Prime.Widgets.Touchable.constructor=Prime.Widgets.Touchable;Prime.Widgets.Touchable.prototype={destroy:function(){this.element.removeEventListener("touchstart",this._handleTouchStart).removeEventListener("touchmove",this._handleTouchMove).removeEventListener("touchcancel",this._handleTouchCancel).removeEventListener("touchend",this._handleTouchEnd).removeEventListenersByPattern(/Prime\.Widgets\.Touchable:.+/)},withLongPressHandler:function(handler){this.element.addEventListener("Prime.Widgets.Touchable:longPress",handler);return this},withMoveHandler:function(handler){this.element.addEventListener("Prime.Widgets.Touchable:move",handler);return this},withSwipeDownHandler:function(handler){this.element.addEventListener("Prime.Widgets.Touchable:swipeDown",handler);return this},withSwipeLeftHandler:function(handler){this.element.addEventListener("Prime.Widgets.Touchable:swipeLeft",handler);return this},withSwipeRightHandler:function(handler){this.element.addEventListener("Prime.Widgets.Touchable:swipeRight",handler);return this},withSwipeUpHandler:function(handler){this.element.addEventListener("Prime.Widgets.Touchable:swipeUp",handler);return this},_collectTouchData:function(event){var touchPoints=event.changedTouches.length;if(touchPoints>1){return}var touch=event.changedTouches[0];this.elapsedTime=(new Date).getTime()-this.touchStarted;this.touchEndX=touch.pageX;this.touchEndY=touch.pageY;this.touchX=this.touchStartX-this.touchEndX;this.touchY=this.touchStartY-this.touchEndY},_finished:function(){var event={elapsedTime:this.elapsedTime,touchStartX:this.touchStartX,touchStartY:this.touchStartY,touchEndX:this.touchEndX,touchEndY:this.touchEndY,touchX:this.touchX,touchY:this.touchY,element:this.element,target:this.element.domElement};event.swipe=Math.abs(event.touchX)>50||Math.abs(event.touchY)>50;event.swipeX=event.swipe&&Math.abs(event.touchX)>Math.abs(event.touchY);event.swipeY=event.swipe&&!event.swipeX;event.longPress=!event.swipe&&event.elapsedTime>500;if(event.longPress){this.element.fireCustomEvent("Prime.Widgets.Touchable:longPress",event)}else if(event.swipeX&&event.touchX>0){this.element.fireCustomEvent("Prime.Widgets.Touchable:swipeLeft",event)}else if(event.swipeX){this.element.fireCustomEvent("Prime.Widgets.Touchable:swipeRight",event)}else if(event.swipeY&&event.touchY>0){this.element.fireCustomEvent("Prime.Widgets.Touchable:swipeUp",event)}else if(event.swipeY){this.element.fireCustomEvent("Prime.Widgets.Touchable:swipeDown",event)}},_handleTouchCancel:function(event){this._collectTouchData(event);this._finished();if(Prime.Utils.isDefined(this.eventPropagationHandler)){this.eventPropagationHandler(event)}},_handleTouchEnd:function(event){this._collectTouchData(event);this._finished();if(Prime.Utils.isDefined(this.eventPropagationHandler)){this.eventPropagationHandler(event)}},_handleTouchMove:function(event){this.element.fireEvent("Prime.Widgets.Touchable:move",event);if(Prime.Utils.isDefined(this.eventPropagationHandler)){this.eventPropagationHandler(event)}},_handleTouchStart:function(event){var touchPoints=event.changedTouches.length;if(touchPoints>1){if(Prime.Utils.isDefined(this.eventPropagationHandler)){this.eventPropagationHandler(event)}return}var touch=event.changedTouches[0];this.touchStarted=(new Date).getTime();this.touchStartX=touch.pageX;this.touchStartY=touch.pageY;if(Prime.Utils.isDefined(this.eventPropagationHandler)){this.eventPropagationHandler(event)}}};"use strict";var Prime=Prime||{};Prime.Window={addEventListener:function(event,listener){if(event.indexOf(":")===-1){window.eventListeners=window.eventListeners||{};window.eventListeners[event]=window.eventListeners[event]||[];window.eventListeners[event].push(listener);if(window.addEventListener){window.addEventListener(event,listener,false)}else if(window.attachEvent){window.attachEvent("on"+event,listener)}else{throw new TypeError("Unable to set event onto the window. Neither addEventListener nor attachEvent methods are available")}}else{window.customEventListeners=window.customEventListeners||{};window.customEventListeners[event]=window.customEventListeners[event]||[];window.customEventListeners[event].push(listener)}return window},getInnerHeight:function(){if(typeof window.innerHeight==="number"){return window.innerHeight}else if(document.documentElement&&document.documentElement.clientHeight){return document.documentElement.clientHeight}else if(document.body&&document.body.clientHeight){return document.body.clientHeight}throw new Error("Unable to determine inner height of the window")},getInnerWidth:function(){if(typeof window.innerWidth==="number"){return window.innerWidth}else if(document.documentElement&&document.documentElement.clientWidth){return document.documentElement.clientWidth}else if(document.body&&document.body.clientWidth){return document.body.clientWidth}throw new Error("Unable to determine inner width of the window")},getScrollTop:function(){if(typeof window.pageYOffset==="number"){return window.pageYOffset}else if(document.body&&document.body.scrollTop){return document.body.scrollTop}else if(document.documentElement&&document.documentElement.scrollTop){return document.documentElement.scrollTop}throw new Error("Unable to determine scrollTop of the window")}};
