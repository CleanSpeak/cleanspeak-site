- if attr? :link
  %a.image{:href=>(attr :link)}
    %img{:id=>@id,
      :class=>['imageblock', @style, role],
      :style=>((css_style = [("text-align: #{attr :align}" if attr? :align), ("float: #{attr :float}" if attr? :float)].compact * '; ').empty? ? nil : css_style),
      :src=>image_uri(attr :target),
      :alt=>(attr :alt),
      :width=>(attr :width),
      :height=>(attr :height)}
- else
  %img{:id=>@id,
      :class=>['imageblock', @style, role],
      :style=>((css_style = [("text-align: #{attr :align}" if attr? :align), ("float: #{attr :float}" if attr? :float)].compact * '; ').empty? ? nil : css_style),
      :src=>image_uri(attr :target),
      :alt=>(attr :alt),
      :width=>(attr :width),
      :height=>(attr :height)}
- if title?
  .title=captioned_title
